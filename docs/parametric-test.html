<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>10 Parametric test | A gentle introduction to R for biologists</title>
<meta name="author" content="Kittinun Leetanaporn">
<meta name="description" content="คือ การวิเคราะห์ทางสถิติที่เราทราบลักษณะการกระจายตัวของข้อมูลอย่างชัดเจน แต่มีข้อดีคือการเปรียบเทียบข้อมูลจะมีความแม่นยำสูง  10.1 \(t\)-test คือ การคำนวณทางสถิติที่เปรียบเทียบค่าเฉลี่ย (Mean)...">
<meta name="generator" content="bookdown 0.36 with bs4_book()">
<meta property="og:title" content="10 Parametric test | A gentle introduction to R for biologists">
<meta property="og:type" content="book">
<meta property="og:description" content="คือ การวิเคราะห์ทางสถิติที่เราทราบลักษณะการกระจายตัวของข้อมูลอย่างชัดเจน แต่มีข้อดีคือการเปรียบเทียบข้อมูลจะมีความแม่นยำสูง  10.1 \(t\)-test คือ การคำนวณทางสถิติที่เปรียบเทียบค่าเฉลี่ย (Mean)...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="10 Parametric test | A gentle introduction to R for biologists">
<meta name="twitter:description" content="คือ การวิเคราะห์ทางสถิติที่เราทราบลักษณะการกระจายตัวของข้อมูลอย่างชัดเจน แต่มีข้อดีคือการเปรียบเทียบข้อมูลจะมีความแม่นยำสูง  10.1 \(t\)-test คือ การคำนวณทางสถิติที่เปรียบเทียบค่าเฉลี่ย (Mean)...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.0/transition.js"></script><script src="libs/bs3compat-0.6.0/tabs.js"></script><script src="libs/bs3compat-0.6.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A gentle introduction to R for biologists</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li class="book-part">Basic R</li>
<li><a class="" href="basic-r.html"><span class="header-section-number">1</span> Basic R</a></li>
<li><a class="" href="r-function.html"><span class="header-section-number">2</span> R function</a></li>
<li><a class="" href="loop.html"><span class="header-section-number">3</span> Loop</a></li>
<li class="book-part">Tidyverse</li>
<li><a class="" href="what-is-tidyverse.html"><span class="header-section-number">4</span> What is tidyverse</a></li>
<li><a class="" href="importing-data.html"><span class="header-section-number">5</span> Importing data</a></li>
<li><a class="" href="data-wrangling.html"><span class="header-section-number">6</span> Data wrangling</a></li>
<li><a class="" href="data-visualization-with-ggplot2.html"><span class="header-section-number">7</span> Data visualization with ggplot2</a></li>
<li><a class="" href="GSE63514.html"><span class="header-section-number">8</span> Example: Microarray data visualization</a></li>
<li class="book-part">Statistical analysis</li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">9</span> Hypothesis testing</a></li>
<li><a class="active" href="parametric-test.html"><span class="header-section-number">10</span> Parametric test</a></li>
<li><a class="" href="non-parametric-test.html"><span class="header-section-number">11</span> Non-parametric test</a></li>
<li><a class="" href="false-discovery.html"><span class="header-section-number">12</span> False discovery</a></li>
<li><a class="" href="regression-model.html"><span class="header-section-number">13</span> Regression model</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">14</span> Survival analysis</a></li>
<li><a class="" href="principal-component-analysis.html"><span class="header-section-number">15</span> Principal component analysis</a></li>
<li class="book-part">Bioconductor</li>
<li><a class="" href="bioconductor.html"><span class="header-section-number">16</span> Bioconductor</a></li>
<li><a class="" href="limma.html"><span class="header-section-number">17</span> Limma</a></li>
<li><a class="" href="edger.html"><span class="header-section-number">18</span> edgeR</a></li>
<li><a class="" href="pathway-analysis.html"><span class="header-section-number">19</span> Pathway analysis</a></li>
<li class="book-part">Supplement</li>
<li><a class="" href="distribution.html"><span class="header-section-number">20</span> Distribution</a></li>
<li class="book-part">Information</li>
<li><a class="" href="session-info.html"><span class="header-section-number">21</span> Session info</a></li>
<li><a class="" href="references.html"><span class="header-section-number">22</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="parametric-test" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Parametric test<a class="anchor" aria-label="anchor" href="#parametric-test"><i class="fas fa-link"></i></a>
</h1>
<p>คือ การวิเคราะห์ทางสถิติที่เราทราบลักษณะการกระจายตัวของข้อมูลอย่างชัดเจน แต่มีข้อดีคือการเปรียบเทียบข้อมูลจะมีความแม่นยำสูง</p>
<div id="sec-t-test" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> <span class="math inline">\(t\)</span>-test<a class="anchor" aria-label="anchor" href="#sec-t-test"><i class="fas fa-link"></i></a>
</h2>
<p>คือ การคำนวณทางสถิติที่เปรียบเทียบค่าเฉลี่ย (Mean) และความผันผวนของการวัด (Standard Error; SE) ระหว่างสองกลุ่ม แบ่งเป็น</p>
<div id="one-t" class="section level3" number="10.1.1">
<h3>
<span class="header-section-number">10.1.1</span> One sample <span class="math inline">\(t\)</span>-test<a class="anchor" aria-label="anchor" href="#one-t"><i class="fas fa-link"></i></a>
</h3>
<p>เป็นการเปรียบเทียบความแตกต่างของค่าเฉลี่ยระหว่างกลุ่มตัวอย่าง (Sample) กับประชากร (Population)</p>
<p><span class="math display">\[
t = \frac{\bar{x} - \mu_{0}}{SE} = \frac{\bar{x} - \mu_{0}}{s/\sqrt{n}}
\]</span></p>
<p>เพื่อให้เห็นภาพของความต่างในการทดสอบนี้ เราจะทำการสร้างกราฟเปรียบว่ากลุ่มตัวอย่างนั้น มีค่าเฉลี่ยต่างจากประชากร ที่ ค่าเฉลี่ย = 10 และ ค่าเฉลี่ย = 30 หรือไม่</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">norm_10_pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># สร้างประชากร mean = 10, sd = 4</span></span>
<span><span class="va">norm_10_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">norm_10_pop</span>, <span class="fl">100</span><span class="op">)</span> <span class="co"># สุ่มตัวอย่างมาจากประชากร 100 ราย</span></span>
<span><span class="va">norm_30_pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, mean <span class="op">=</span> <span class="fl">30</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">norm_30_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">norm_30_pop</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">norm_pop_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Pop_10 <span class="op">=</span> <span class="va">norm_10_pop</span>, Pop_30 <span class="op">=</span> <span class="va">norm_30_pop</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Pop"</span>, values_to <span class="op">=</span> <span class="st">"Values"</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">norm_sample_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Samp_10 <span class="op">=</span> <span class="va">norm_10_sample</span>, Samp_30 <span class="op">=</span> <span class="va">norm_30_sample</span><span class="op">)</span> <span class="op">|&gt;</span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Samp"</span>, values_to <span class="op">=</span> <span class="st">"Values"</span><span class="op">)</span>  </span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">norm_pop_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Values</span>, fill <span class="op">=</span> <span class="va">Pop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>    </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span>,color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">norm_sample_df</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x  <span class="op">=</span> <span class="va">Values</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">Samp</span><span class="op">)</span>, </span>
<span>               color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figure/one_t_plot-1.png" width="100%"></div>
<p>จะเห็นว่าเมื่อดูลักษณะการกระจายตัวของข้อมูลแล้ว <code>Samp_10</code> ที่มี ค่าเฉลี่ย = 10 นั้น ไม่ต่างจากประชากรที่มี ค่าเฉลี่ย = 10 แต่ดูแตกต่างอย่างเห็นได้ชัดกับประชากรที่มี mean = 30 <code>t.test</code> จะช่วยตัดสินว่าค่าที่ได้นั้นแตกต่างกันจริงหรือไม่ โดยสมมติฐานที่ตั้งคือ</p>
<p><strong>Case 1</strong>: ประชากรมีค่าเฉลี่ย = 10</p>
<ul>
<li><p><span class="math inline">\(H_{0}\)</span>: ค่าเฉลี่ยของกลุ่มตัวอย่างนั้น ไม่ต่างจากค่าเฉลี่ยของประชากร = 10</p></li>
<li><p><span class="math inline">\(H_{a}\)</span>: ค่าเฉลี่ยของกลุ่มตัวอย่างนั้น ต่างจากค่าเฉลี่ยของประชากร = 10</p></li>
</ul>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">norm_10_sample</span>, mu <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># p &gt; 0.05</span></span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  norm_10_sample
## t = 0.73547, df = 99, p-value = 0.4638
## alternative hypothesis: true mean is not equal to 10
## 95 percent confidence interval:
##   9.533936 11.015052
## sample estimates:
## mean of x 
##  10.27449</code></pre>
<p><strong>Case 2</strong>: ประชากรมีค่าเฉลี่ย = 40</p>
<ul>
<li><p><span class="math inline">\(H_{0}\)</span>: ค่าเฉลี่ยของกลุ่มตัวอย่างนั้น ไม่ต่างจากค่าเฉลี่ยของประชากร = 40</p></li>
<li><p><span class="math inline">\(H_{a}\)</span>: ค่าเฉลี่ยของกลุ่มตัวอย่างนั้น ต่างจากค่าเฉลี่ยของประชากร = 40</p></li>
</ul>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">norm_10_sample</span>, mu <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="co"># p &lt;= 0.05</span></span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  norm_10_sample
## t = -52.852, df = 99, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 30
## 95 percent confidence interval:
##   9.533936 11.015052
## sample estimates:
## mean of x 
##  10.27449</code></pre>
<p>จะเห็นว่าต่างจากประชากรที่ค่าเฉลี่ย = 30 อย่างมีนัยสำคัญ (<span class="math inline">\(p\)</span> = <span class="math inline">\(2.2 \times 10^{-16}\)</span> &lt; Critical point = 0.05)</p>
<p>พิจารณาที่มาของ <span class="math inline">\(p\)</span>-value นั้นมีที่มาจากสูตรขั้นต้น</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hypothesized_mean</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">mean_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">norm_10_sample</span><span class="op">)</span></span>
<span><span class="va">sd_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">norm_10_sample</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mean_sample</span> <span class="op">-</span> <span class="va">hypothesized_mean</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">sd_sample</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">norm_10_sample</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t</span></span></code></pre></div>
<pre><code>## [1] -52.85159</code></pre>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="va">t</span>, df <span class="op">=</span> <span class="fl">99</span><span class="op">)</span> <span class="co"># p-value</span></span></code></pre></div>
<pre><code>## [1] 2.306252e-74</code></pre>
<p>จะเห็นว่าค่า <span class="math inline">\(t\)</span> นั้นเท่ากับ ค่าที่ได้จาก <code>t.test</code> ขั้นต้น เมื่อสร้าง <span class="math inline">\(t\)</span>-distribution ที่มี <span class="math inline">\(H_{0}\)</span> คือ ค่าเฉลี่ย = 0 แล้วจะพบว่าค่านี้มากกว่า Critical value</p>
</div>
<div id="ind-t" class="section level3" number="10.1.2">
<h3>
<span class="header-section-number">10.1.2</span> Independent t-test<a class="anchor" aria-label="anchor" href="#ind-t"><i class="fas fa-link"></i></a>
</h3>
<p>เป็นการเปรียบเทียบค่าเฉลี่ยระหว่าง ตัวอย่างสองกลุ่มที่ไม่เกี่ยวเนื่องกัน</p>
<p><span class="math display">\[
t = \frac{\bar{x_{1}}-\bar{x_{2}}-\mu_{0}}{\sqrt{\frac{s^{2}_1}{n_{1}}+\frac{s^{2}_2}{n_{2}}}}
\]</span></p>
<p><span class="math display">\[
s_{p} = \sqrt{\frac{(n_{1}-1)s^{2}_{1}+(n_{2}-1)s^{2}_{2}}{{n_{1}} + n_{2} - 2}}
\]</span></p>
<p>กลับไปดูภาพขั้นต้น ครั้งนี้จะเทียบระหว่างกลุ่มตัวอย่างสองกลุ่ม คือ <code>norm_10_sample</code> และ <code>norm_30_sample</code> ว่ามี ค่าเฉลี่ยที่แตกต่างกันอย่างมีนัยสำคัญหรือไม่</p>
<ul>
<li><p><span class="math inline">\(H_{0}\)</span>: ค่าเฉลี่ยของ <code>norm_10_sample</code> และ <code>norm_30_sample</code> นั้นไม่แตกต่างกัน (<span class="math inline">\(\bar{x_{1}} - \bar{x_{2}} = 0\)</span>)</p></li>
<li><p><span class="math inline">\(H_{a}\)</span>: ค่าเฉลี่ยของ <code>norm_10_sample</code> และ <code>norm_30_sample</code> นั้นแตกต่างกัน (<span class="math inline">\(\bar{x_{1}} - \bar{x_{2}} \neq 0\)</span>)</p></li>
</ul>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">norm_10_sample</span>, <span class="va">norm_30_sample</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  norm_10_sample and norm_30_sample
## t = -38.469, df = 198, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -20.93623 -18.89440
## sample estimates:
## mean of x mean of y 
##  10.27449  30.18981</code></pre>
<p>สรุปได้ว่าค่าเฉลี่ยของกลุ่มตัวอย่างทั้งสองกลุ่มนั้นแตกต่างกันอย่างมีนัยสำคัญ</p>
<p>ลองคำนวณเอง</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ind_t_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ten <span class="op">=</span> <span class="va">norm_10_sample</span>, thirty <span class="op">=</span> <span class="va">norm_30_sample</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, .fns <span class="op">=</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ind_t_df</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["ten_mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["ten_sd"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["thirty_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["thirty_sd"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"10.27449","2":"3.732245","3":"30.18981","4":"3.587701"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ind_t_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">ind_t_df</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">ten_sd</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span> <span class="op">+</span> <span class="op">(</span><span class="va">thirty_sd</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span> <span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">ind_t_se</span></span></code></pre></div>
<pre><code>## [1] 0.5176993</code></pre>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ind_t</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ind_t_df</span><span class="op">$</span><span class="va">ten_mean</span> <span class="op">-</span> <span class="va">ind_t_df</span><span class="op">$</span><span class="va">thirty_mean</span> <span class="op">-</span> <span class="fl">0</span><span class="op">)</span><span class="op">/</span><span class="va">ind_t_se</span></span>
<span><span class="va">ind_t</span></span></code></pre></div>
<pre><code>## [1] -38.46889</code></pre>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="va">ind_t</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">norm_10_sample</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">norm_30_sample</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span></span></code></pre></div>
<pre><code>## [1] 7.928494e-94</code></pre>
<p><strong>Note:</strong> บางครั้งข้อมูลอาจจะมีความแปรปรวนไม่เท่ากัน ในที่นี้มักจะใช้ Welch’s <span class="math inline">\(t\)</span>-test โดย <code>t.test(…, var.equal = FALSE)</code> โดยสมการนี้จะทำการปรับความแปรปรวนให้ด้วย</p>
</div>
<div id="pair-t" class="section level3" number="10.1.3">
<h3>
<span class="header-section-number">10.1.3</span> Paired t-test<a class="anchor" aria-label="anchor" href="#pair-t"><i class="fas fa-link"></i></a>
</h3>
<p>เป็นการเปรียบเทียบค่าเฉลี่ยระหว่างตัวอย่างสองกลุ่มที่เกี่ยวเนื่องกัน (ก่อน-หลัง แม่-ลูก เป็นต้น)</p>
<p><span class="math display">\[
t = \frac{\bar{x}_{d}-\mu_{0}}{s_{x_{d}}/\sqrt{n}}
\]</span></p>
<p><span class="math display">\[
x_{di} = x_{1_{i}}-x_{2_{i}}
\]</span></p>
<p><span class="math display">\[
s_{x_{d}} = \sqrt{\frac{\sum_{d=1}^{n}(x_{d}-\bar{x}_{d})^{2}}{(n-1)}}
\]</span></p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">norm_10_sample</span>, <span class="va">norm_30_sample</span>, paired <span class="op">=</span> <span class="cn">TRUE</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  norm_10_sample and norm_30_sample
## t = -37.802, df = 99, p-value &lt; 2.2e-16
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  -20.96067 -18.86996
## sample estimates:
## mean difference 
##       -19.91532</code></pre>
<p>จะเห็นว่ามีความแตกต่างในส่วนของ <span class="math inline">\(df\)</span> (Degree of freedom) ซึ่งเกิดจากการจับคู่หาความต่าง 100 ครั้ง เนื่องจากค่าที่เปรียบเทียบนั้นอยู่ในตัวอย่างเดียวกัน (แม่ลูก คู่ที่ 1 แม่ลูกคู่ที่ 2 … เป็นต้น) เมื่อเปรียบเทียบกับ Independent <span class="math inline">\(t\)</span>-test เนื่องจากเป็นการหา mean ในกลุ่มของตัวเอง 2 ครั้ง และมาเทียบความต่างกัน</p>
<p>ลองคำนวณเอง</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paired_t_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ten <span class="op">=</span> <span class="va">norm_10_sample</span>, thirty <span class="op">=</span> <span class="va">norm_30_sample</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">ten</span> <span class="op">-</span><span class="va">thirty</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mean_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ss_mean_diff <span class="op">=</span> <span class="op">(</span><span class="va">diff</span><span class="op">-</span><span class="va">mean_diff</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">paired_t_df</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["ten"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["thirty"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["diff"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean_diff"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ss_mean_diff"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"8.545371","2":"36.30123","3":"-27.755860","4":"-19.91532","5":"6.147413e+01"},{"1":"16.394035","2":"32.29470","3":"-15.900665","4":"-19.91532","5":"1.611742e+01"},{"1":"6.664626","2":"32.61089","3":"-25.946265","4":"-19.91532","5":"3.637234e+01"},{"1":"10.414552","2":"25.46616","3":"-15.051608","4":"-19.91532","5":"2.365565e+01"},{"1":"10.999299","2":"39.46022","3":"-28.460923","4":"-19.91532","5":"7.302740e+01"},{"1":"14.441108","2":"36.19822","3":"-21.757113","4":"-19.91532","5":"3.392216e+00"},{"1":"2.245981","2":"28.68384","3":"-26.437863","4":"-19.91532","5":"4.254363e+01"},{"1":"12.693015","2":"32.96511","3":"-20.272094","4":"-19.91532","5":"1.272906e-01"},{"1":"10.466549","2":"33.54045","3":"-23.073901","4":"-19.91532","5":"9.976658e+00"},{"1":"8.939420","2":"34.44552","3":"-25.506102","4":"-19.91532","5":"3.125689e+01"},{"1":"4.708196","2":"33.04441","3":"-28.336214","4":"-19.91532","5":"7.091153e+01"},{"1":"3.528469","2":"33.35288","3":"-29.824408","4":"-19.91532","5":"9.819011e+01"},{"1":"4.965405","2":"29.71922","3":"-24.753818","4":"-19.91532","5":"2.341110e+01"},{"1":"5.594066","2":"34.38098","3":"-28.786911","4":"-19.91532","5":"7.870520e+01"},{"1":"9.610523","2":"27.25590","3":"-17.645381","4":"-19.91532","5":"5.152604e+00"},{"1":"7.991205","2":"31.54434","3":"-23.553133","4":"-19.91532","5":"1.323371e+01"},{"1":"14.439393","2":"30.26027","3":"-15.820880","4":"-19.91532","5":"1.676441e+01"},{"1":"12.200176","2":"31.70408","3":"-19.503906","4":"-19.91532","5":"1.692580e-01"},{"1":"10.585669","2":"29.14315","3":"-18.557485","4":"-19.91532","5":"1.843704e+00"},{"1":"9.638722","2":"30.29602","3":"-20.657299","4":"-19.91532","5":"5.505392e-01"},{"1":"7.585875","2":"31.27793","3":"-23.692051","4":"-19.91532","5":"1.426373e+01"},{"1":"12.215671","2":"28.53238","3":"-16.316710","4":"-19.91532","5":"1.294997e+01"},{"1":"5.601796","2":"30.13811","3":"-24.536314","4":"-19.91532","5":"2.135363e+01"},{"1":"13.161541","2":"26.82955","3":"-13.668012","4":"-19.91532","5":"3.902881e+01"},{"1":"12.959790","2":"24.72350","3":"-11.763707","4":"-19.91532","5":"6.644873e+01"},{"1":"13.119860","2":"33.47336","3":"-20.353498","4":"-19.91532","5":"1.920036e-01"},{"1":"15.936124","2":"32.05594","3":"-16.119811","4":"-19.91532","5":"1.440585e+01"},{"1":"2.606109","2":"25.02033","3":"-22.414221","4":"-19.91532","5":"6.244525e+00"},{"1":"15.522058","2":"32.22898","3":"-16.706925","4":"-19.91532","5":"1.029377e+01"},{"1":"6.012644","2":"26.05784","3":"-20.045199","4":"-19.91532","5":"1.686974e-02"},{"1":"15.106315","2":"30.42894","3":"-15.322625","4":"-19.91532","5":"2.109281e+01"},{"1":"11.899647","2":"32.86533","3":"-20.965680","4":"-19.91532","5":"1.103264e+00"},{"1":"4.418903","2":"37.96721","3":"-33.548305","4":"-19.91532","5":"1.858584e+02"},{"1":"12.544496","2":"28.56425","3":"-16.019758","4":"-19.91532","5":"1.517537e+01"},{"1":"4.224427","2":"27.00828","3":"-22.783853","4":"-19.91532","5":"8.228504e+00"},{"1":"7.555336","2":"27.80949","3":"-20.254153","4":"-19.91532","5":"1.148107e-01"},{"1":"11.484592","2":"26.71497","3":"-15.230374","4":"-19.91532","5":"2.194868e+01"},{"1":"12.639611","2":"29.21640","3":"-16.576794","4":"-19.91532","5":"1.114573e+01"},{"1":"8.341645","2":"27.86826","3":"-19.526616","4":"-19.91532","5":"1.510877e-01"},{"1":"9.881224","2":"23.00651","3":"-13.125287","4":"-19.91532","5":"4.610450e+01"},{"1":"10.857781","2":"34.65286","3":"-23.795077","4":"-19.91532","5":"1.505255e+01"},{"1":"9.472500","2":"29.55043","3":"-20.077932","4":"-19.91532","5":"2.644393e-02"},{"1":"9.223390","2":"25.62680","3":"-16.403407","4":"-19.91532","5":"1.233351e+01"},{"1":"6.725321","2":"33.39923","3":"-26.673906","4":"-19.91532","5":"4.567854e+01"},{"1":"15.015260","2":"38.04517","3":"-23.029912","4":"-19.91532","5":"9.700710e+00"},{"1":"4.994915","2":"25.86077","3":"-20.865853","4":"-19.91532","5":"9.035215e-01"},{"1":"14.611745","2":"27.62329","3":"-13.011545","4":"-19.91532","5":"4.766206e+01"},{"1":"5.746695","2":"30.69242","3":"-24.945724","4":"-19.91532","5":"2.530501e+01"},{"1":"12.273154","2":"31.23091","3":"-18.957753","4":"-19.91532","5":"9.169273e-01"},{"1":"11.105098","2":"24.38604","3":"-13.280941","4":"-19.91532","5":"4.401492e+01"},{"1":"13.016215","2":"35.95248","3":"-22.936265","4":"-19.91532","5":"9.126131e+00"},{"1":"17.373065","2":"23.93870","3":"-6.565638","4":"-19.91532","5":"1.782139e+02"},{"1":"8.198646","2":"31.35817","3":"-23.159529","4":"-19.91532","5":"1.052492e+01"},{"1":"15.052741","2":"30.56510","3":"-15.512363","4":"-19.91532","5":"1.938599e+01"},{"1":"18.026723","2":"31.33872","3":"-13.311992","4":"-19.91532","5":"4.360388e+01"},{"1":"8.601398","2":"25.26880","3":"-16.667404","4":"-19.91532","5":"1.054893e+01"},{"1":"5.507566","2":"27.22025","3":"-21.712687","4":"-19.91532","5":"3.230543e+00"},{"1":"12.613031","2":"30.85792","3":"-18.244887","4":"-19.91532","5":"2.790333e+00"},{"1":"6.507716","2":"33.01318","3":"-26.505464","4":"-19.91532","5":"4.343005e+01"},{"1":"5.649677","2":"26.03441","3":"-20.384736","4":"-19.91532","5":"2.203549e-01"},{"1":"5.210546","2":"33.39878","3":"-28.188238","4":"-19.91532","5":"6.844123e+01"},{"1":"10.964184","2":"30.83853","3":"-19.874348","4":"-19.91532","5":"1.678402e-03"},{"1":"7.799105","2":"31.01491","3":"-23.215800","4":"-19.91532","5":"1.089320e+01"},{"1":"11.492966","2":"30.42876","3":"-18.935790","4":"-19.91532","5":"9.594719e-01"},{"1":"16.190324","2":"25.07828","3":"-8.887952","4":"-19.91532","5":"1.216028e+02"},{"1":"2.995730","2":"32.50141","3":"-29.505676","4":"-19.91532","5":"9.197501e+01"},{"1":"11.829848","2":"35.43466","3":"-23.604815","4":"-19.91532","5":"1.361240e+01"},{"1":"8.168958","2":"34.09281","3":"-25.923849","4":"-19.91532","5":"3.610247e+01"},{"1":"5.628851","2":"34.16151","3":"-28.532657","4":"-19.91532","5":"7.425857e+01"},{"1":"12.045883","2":"28.73625","3":"-16.690369","4":"-19.91532","5":"1.040028e+01"},{"1":"11.240921","2":"27.85779","3":"-16.616865","4":"-19.91532","5":"1.087978e+01"},{"1":"13.764663","2":"33.79264","3":"-20.027974","4":"-19.91532","5":"1.269184e-02"},{"1":"9.714768","2":"36.87617","3":"-27.161400","4":"-19.91532","5":"5.250573e+01"},{"1":"11.968914","2":"30.44648","3":"-18.477568","4":"-19.91532","5":"2.067120e+00"},{"1":"7.909533","2":"33.03816","3":"-25.128630","4":"-19.91532","5":"2.717864e+01"},{"1":"4.231861","2":"29.19265","3":"-24.960786","4":"-19.91532","5":"2.545677e+01"},{"1":"17.636414","2":"28.64447","3":"-11.008051","4":"-19.91532","5":"7.933937e+01"},{"1":"7.610680","2":"29.20152","3":"-21.590844","4":"-19.91532","5":"2.807395e+00"},{"1":"16.750358","2":"30.21917","3":"-13.468813","4":"-19.91532","5":"4.155740e+01"},{"1":"13.362159","2":"24.87996","3":"-11.517805","4":"-19.91532","5":"7.051819e+01"},{"1":"11.498574","2":"27.86153","3":"-16.362959","4":"-19.91532","5":"1.261924e+01"},{"1":"9.057199","2":"27.60676","3":"-18.549558","4":"-19.91532","5":"1.865294e+00"},{"1":"14.282064","2":"22.12535","3":"-7.843290","4":"-19.91532","5":"1.457338e+02"},{"1":"6.903420","2":"28.12830","3":"-21.224876","4":"-19.91532","5":"1.714947e+00"},{"1":"13.533211","2":"31.10979","3":"-17.576576","4":"-19.91532","5":"5.469704e+00"},{"1":"9.054882","2":"28.66265","3":"-19.607766","4":"-19.91532","5":"9.458691e-02"},{"1":"10.569834","2":"26.65642","3":"-16.086590","4":"-19.91532","5":"1.465914e+01"},{"1":"10.884078","2":"25.69441","3":"-14.810335","4":"-19.91532","5":"2.606083e+01"},{"1":"11.013274","2":"27.69656","3":"-16.683288","4":"-19.91532","5":"1.044601e+01"},{"1":"9.613256","2":"32.89870","3":"-23.285449","4":"-19.91532","5":"1.135780e+01"},{"1":"12.248166","2":"27.54805","3":"-15.299883","4":"-19.91532","5":"2.130222e+01"},{"1":"11.641100","2":"27.65166","3":"-16.010557","4":"-19.91532","5":"1.524714e+01"},{"1":"11.252915","2":"30.48136","3":"-19.228447","4":"-19.91532","5":"4.717889e-01"},{"1":"10.682352","2":"31.69920","3":"-21.016847","4":"-19.91532","5":"1.213370e+00"},{"1":"5.977455","2":"29.31555","3":"-23.338094","4":"-19.91532","5":"1.171541e+01"},{"1":"15.342070","2":"28.75088","3":"-13.408807","4":"-19.91532","5":"4.233466e+01"},{"1":"13.148534","2":"25.71772","3":"-12.569183","4":"-19.91532","5":"5.396566e+01"},{"1":"11.724396","2":"32.55743","3":"-20.833030","4":"-19.91532","5":"8.421996e-01"},{"1":"14.439681","2":"36.46631","3":"-22.026629","4":"-19.91532","5":"4.457645e+00"},{"1":"9.610195","2":"29.44665","3":"-19.836460","4":"-19.91532","5":"6.218304e-03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_sd</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">paired_t_df</span><span class="op">$</span><span class="va">ss_mean_diff</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">paired_t_df</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t_sd</span></span></code></pre></div>
<pre><code>## [1] 5.268367</code></pre>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_paired</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">paired_t_df</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">t_sd</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">paired_t_df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">t_paired</span></span></code></pre></div>
<pre><code>## [1] -37.80168</code></pre>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="va">t_paired</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">paired_t_df</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span></span></code></pre></div>
<pre><code>## [1] 1.223407e-60</code></pre>
<p>ดังนั้น การเลือก Paired vs Independent นั้นมีความสำคัญ ขึ้นอยู่กับโจทย์การศึกษาของท่านด้วย</p>
<hr>
</div>
</div>
<div id="ANOVA" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Analysis of Variance (ANOVA)<a class="anchor" aria-label="anchor" href="#ANOVA"><i class="fas fa-link"></i></a>
</h2>
<p>คือ การคำนวณทางสถิติที่เปรียบเทียบค่าเฉลี่ยและความแปรปรวนระหว่างสองกลุ่มขึ้นไป โดยมีสมมติฐาน คือ</p>
<ul>
<li><p><span class="math inline">\(H_{0}\)</span>: ค่าเฉลี่ยของทุกกลุ่มเท่ากัน (<span class="math inline">\(\bar{x_{1}} = \bar{x_{2}} = \bar{x_{3}} = … = \bar{x_{n}}\)</span>)</p></li>
<li><p><span class="math inline">\(H_{a}\)</span>: ค่าเฉลี่ยของ<strong>กลุ่มใดกลุ่มหนึ่ง</strong>ต่างจากกลุ่มอื่น</p></li>
</ul>
<p>การวิเคราะห์ ANOVA นั้นมีหลายแบบ</p>
<ul>
<li><p><strong>One-way ANOVA</strong> เป็นการหาความแตกต่างของ 1 ตัวแปร</p></li>
<li><p><strong>Two-way ANOVA</strong> เป็นการหาความแตกต่างของ 2 ตัวแปร</p></li>
<li><p><strong>MANOVA</strong> เป็นการหาความแตกต่างที่มากกว่า 2 ตัวแปร</p></li>
<li><p><strong>Nested ANOVA</strong> เป็นการหาความแตกต่างที่ใน 1 ตัวแปรนั้น มีตัวแปรย่อยอีก</p></li>
</ul>
<p>ณ ที่นี้จะกล่าวถึงแค่ one ANOVA ซึ่งมีความซับซ้อนน้อย และนิยมใช้มากที่สุด โดยหลักการโดยง่ายของ ANOVA คือ การเปรียบเทียบความต่างของ <strong>ค่าเฉลี่ยทั้งกลุ่ม (Global mean)</strong> เปรียบเทียบกับ <strong>ผลรวมของค่าเฉลี่ยแต่ละกลุ่ม (Between group mean)</strong></p>
<p>การวิเคราะห์ทางสถิติของ ANOVA นั้นใช้ <span class="math inline">\(F\)</span>-test ซึ่งเป็นการเปรียบเทียบระหว่าง ความแปรปรวนที่อธิบายได้ และความแปรปรวนที่อธิบายไม่ได้</p>
<p><span class="math display">\[F^{*} = \frac{\text{Explained variance}}{\text{Unexplained variance}} =  \frac{\text{Between group variance}}{\text{Within groups variance}}\]</span></p>
<ul>
<li><p><strong>Between group variance</strong> คือ ความแปรปรวนของค่าเฉลี่ยแต่ละกลุ่มกับค่าเฉลี่ยทั้งหมด</p></li>
<li><p><strong>Within group variance</strong> คือ ความแปรปรวนของข้อมูลในกลุ่มนั้น ซึ่งไม่สามารถอธิบายได้ภายใต้สมมติฐานงานวิจัยนั้น</p></li>
</ul>
<p>อธิบายโดยใช้ตัวอย่าง iris ในที่นี้เราจะเปรียบเทียบตวามต่างของ <code>Sepal.Width</code> ในแต่ละ <code>Species</code></p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## Species       2  11.35   5.672   49.16 &lt;2e-16 ***
## Residuals   147  16.96   0.115                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>อธิบายด้วยภาพ</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">granova</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/granova/man/granova.1w.html">granova.1w</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Width</span>, group <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figure/granova-1.png" width="672"></div>
<pre><code>## $grandsum
##     Grandmean        df.bet       df.with        MS.bet       MS.with        F.stat        F.prob 
##          3.06          2.00        147.00          5.67          0.12         49.16          0.00 
## SS.bet/SS.tot 
##          0.40 
## 
## $stats
##            Size Contrast Coef Wt'd Mean Mean Trim'd Mean Var. St. Dev.
## versicolor   50         -0.29      2.77 2.77        2.80 0.10     0.31
## virginica    50         -0.08      2.97 2.97        2.96 0.10     0.32
## setosa       50          0.37      3.43 3.43        3.41 0.14     0.38</code></pre>
<ul>
<li><p><strong>รูปสามเหลี่ยม</strong> คือ ค่าเฉลี่ยของ <code>Petal.Width</code> ในดอกไม้แต่ละ <code>Species</code></p></li>
<li><p><strong>จุดสีดำ</strong> คือ ค่า <code>Petal.Width</code> ในดอกไม้แต่ละดอก</p></li>
<li><p><strong>จุดสีเขียว</strong> คือ Global mean (Grand mean) คือ ค่าเฉลี่ย <code>Petal.Width</code> เมื่อรวมดอกไม้ทุก <code>Species</code></p></li>
</ul>
<p>จุดประสงค์ของ F-test คือการเปรียบเทียบอัตราส่วนระหว่าง ความแปรปรวนของค่าเฉลี่ยแต่ละกลุ่มกับค่าเฉลี่ยทั้งหมด (mean ของความต่างจุดเขียวกับสามเหลี่ยม) ใกล้กันกับความแปรปรวนของข้อมูลในกลุ่มนั้น (mean ของความต่างระหว่างจุดดำกับกับสามเหลี่ยม) หรือไม่ (ratio ~ 1) ซึ่งค่า <span class="math inline">\(F\)</span> นั้นจะถูกนำไปคิด <span class="math inline">\(p\)</span>-value จาก <span class="math inline">\(F\)</span>-distribution (หลักการเดียวกันกับ <span class="math inline">\(t\)</span>-test)</p>
<p><strong>สังเกตว่า</strong> ท่านไม่สามารถบอกได้ว่ากลุ่มไหนเป็นกลุ่มที่มีค่าเฉลี่ยที่แตกต่างจากทั้งกลุ่ม การที่จะทราบนั้นต้องทำ <code>t.test</code> เปรียบเทียบกันในแต่ละกลุ่ม <span class="math inline">\(3\choose2\)</span> = 3 ครั้ง การค้นหากลุ่มที่มีความต่างหลัง ANOVA นี้ เรียกว่า Post-hoc test</p>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Width</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  iris$Sepal.Width and iris$Species 
## 
##            setosa  versicolor
## versicolor &lt; 2e-16 -         
## virginica  9.1e-10 0.0031    
## 
## P value adjustment method: holm</code></pre>
<p><span class="math inline">\(p\)</span>-value &lt; 0.05 ทุกกลุ่ม หมายความว่า ทุกกลุ่มมีค่าเฉลี่ยของ <code>Petal.Width</code> ที่แตกต่างกัน</p>
</div>
<div id="correlation-test" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Correlation test<a class="anchor" aria-label="anchor" href="#correlation-test"><i class="fas fa-link"></i></a>
</h2>
<div id="pearson" class="section level3" number="10.3.1">
<h3>
<span class="header-section-number">10.3.1</span> Pearson correlation<a class="anchor" aria-label="anchor" href="#pearson"><i class="fas fa-link"></i></a>
</h3>
<p>เป็นการทดสอบความสัมพันธ์<strong>เชิงเส้น</strong>ของตัวแปรสองตัวแปร</p>
<p><span class="math display">\[
r_{xy} =\frac{cov(x,y)}{s(x) s(y)}
\]</span></p>
<p><span class="math display">\[
cov(x,y) = \frac{\sum^{n}_{i=1}(x_{i}-\bar{x})(y_{i}-\bar{y})}{n-1}
\]</span></p>
<p><span class="math display">\[
\therefore r_{xy} = \frac{\sum^{n}_{i=1}(x_{i}-\bar{x})(y_{i}-\bar{y})}{\sqrt{\sum^{n}_{i=1}(x_{i}-\bar{x})^{2}}\sqrt{\sum^{n}_{i=1}(y_{i}-\bar{y})^{2}}}
\]</span></p>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Petal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figure/cor_iris-1.png" width="672"></div>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Petal.Length</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.8717538</code></pre>
<p>การแปลผลของ Correlation ขึ้นอยู่กับ</p>
<ul>
<li><p>ระดับของความสัมพันธ์ = 0-1 ยิ่งเข้าใกล้ 1 ยิ่งสัมพันธ์กันมาก</p></li>
<li><p>ทิศทางของความสัมพันธ์ = + ไปทิศทางเดียวกัน - ไปทิศทางตรงข้ามกัน</p></li>
</ul>
<p>ท่านสามารถสร้างตาราง Correlation และ <span class="math inline">\(p\)</span>-value ได้ด้วย Package <code>corrplot</code></p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">iris_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">iris_cor</span></span></code></pre></div>
<pre><code>##              Sepal.Length Sepal.Width Petal.Length Petal.Width
## Sepal.Length    1.0000000  -0.1175698    0.8717538   0.8179411
## Sepal.Width    -0.1175698   1.0000000   -0.4284401  -0.3661259
## Petal.Length    0.8717538  -0.4284401    1.0000000   0.9628654
## Petal.Width     0.8179411  -0.3661259    0.9628654   1.0000000</code></pre>
<div class="sourceCode" id="cb293"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris_cor_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/cor.mtest.html">cor.mtest</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">iris_cor_p</span></span></code></pre></div>
<pre><code>## $p
##              Sepal.Length  Sepal.Width Petal.Length  Petal.Width
## Sepal.Length 0.000000e+00 1.518983e-01 1.038667e-47 2.325498e-37
## Sepal.Width  1.518983e-01 0.000000e+00 4.513314e-08 4.073229e-06
## Petal.Length 1.038667e-47 4.513314e-08 0.000000e+00 4.675004e-86
## Petal.Width  2.325498e-37 4.073229e-06 4.675004e-86 0.000000e+00
## 
## $lowCI
##              Sepal.Length Sepal.Width Petal.Length Petal.Width
## Sepal.Length    1.0000000  -0.2726932    0.8270363   0.7568971
## Sepal.Width    -0.2726932   1.0000000   -0.5508771  -0.4972130
## Petal.Length    0.8270363  -0.5508771    1.0000000   0.9490525
## Petal.Width     0.7568971  -0.4972130    0.9490525   1.0000000
## 
## $uppCI
##              Sepal.Length Sepal.Width Petal.Length Petal.Width
## Sepal.Length   1.00000000  0.04351158    0.9055080   0.8648361
## Sepal.Width    0.04351158  1.00000000   -0.2879499  -0.2186966
## Petal.Length   0.90550805 -0.28794993    1.0000000   0.9729853
## Petal.Width    0.86483606 -0.21869663    0.9729853   1.0000000</code></pre>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">iris_cor</span>, method <span class="op">=</span> <span class="st">"shade"</span>,type <span class="op">=</span> <span class="st">"upper"</span>,order <span class="op">=</span> <span class="st">"AOE"</span>, </span>
<span>         p.mat <span class="op">=</span> <span class="va">iris_cor_p</span><span class="op">$</span><span class="va">p</span>, insig <span class="op">=</span> <span class="st">"p-value"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figure/corrplot-1.png" width="672"></div>
<p><strong>ข้อควรระวัง</strong> <span class="math inline">\(p\)</span>-value ของ Correlation test นั้นอยู่ภายใต้สมมติฐาน (<span class="math inline">\(t\)</span>-test/<span class="math inline">\(F\)</span>-test)</p>
<ul>
<li><p><span class="math inline">\(H_{0}\)</span>: ไม่มีความสัมพันธ์เชิงเส้นของทั้งสองตัวแปร (<span class="math inline">\(r_{xy} = 0\)</span>)</p></li>
<li><p><span class="math inline">\(H_{0}\)</span>: มีความสัมพันธ์เชิงเส้นของทั้งสองตัวแปร (<span class="math inline">\(r_{xy} \neq 0\)</span>)</p></li>
</ul>
<p>ซึ่งถ้า <span class="math inline">\(p\)</span> &lt; 0.05 หมายความว่า ท่านมีความมั่นใจมากเพียงพอว่า ความสัมพันธ์เชิงเส้นของทั้งสองตัวแปรนั้น มีมากกว่าการวาดเส้นจากการสร้างจุดแบบสุ่ม ท่านยังคงต้องแปรผลร่วมกับค่า Correlation coefficient ต่อไป</p>
<p>เช่น</p>
<ul>
<li><p><span class="math inline">\(r_{x,y}\)</span> = 0.2, <span class="math inline">\(p\)</span> &lt; 0.05 มั่นใจว่ามีความสัมพันธ์เชิงเส้นของสองตัวแปร ความสัมพันธ์เป็นไปในทิศทางเดียวกัน แต่ความสัมพันธ์เชิงเส้นอยู่ในระดับน้อย</p></li>
<li><p><span class="math inline">\(r_{x,y}\)</span> = 1, <span class="math inline">\(p\)</span> = 1 ความสัมพันธ์เชิงเส้นอยู่ในระดับดีเยี่ยม แต่ไม่มั่นใจว่ามีความสัมพันธ์กันจริงหรือไม่ เนื่องจากข้อมูลน้อย (เช่น มีข้อมูลเพียงสองจุด <span class="math inline">\(r_{x,y}\)</span> ย่อมเท่ากับ 1)</p></li>
<li><p><span class="math inline">\(r_{x,y}\)</span> = 0.3, <span class="math inline">\(p\)</span> = 1 ความสัมพันธ์เชิงเส้นอยู่ในระดับน้อย แต่ไม่มั่นใจว่ามีความสัมพันธ์กันจริงหรือไม่ เนื่องจากข้อมูลน้อยเกินไป ควรเก็บข้อมูลเพิ่ม</p></li>
<li><p><span class="math inline">\(r_{x,y}\)</span> = -1, <span class="math inline">\(p\)</span> &lt; 0.05 มั่นใจว่ามีความสัมพันธ์เชิงเส้นของสองตัวแปร ความสัมพันธ์เป็นไปในทิศทางตรงข้าม และความสัมพันธ์เชิงเส้นอยู่ในระดับดีเยี่ยม</p></li>
</ul>
<p>นั่นหมายความว่า ยิ่งจำนวนตัวอย่างเพิ่มขึ้น <strong>ความมั่นใจ</strong>ยิ่งเพิ่มขึ้น <strong>ไม่ใช่ความสัมพันธ์เพิ่มขึ้น</strong></p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="hypothesis-testing.html"><span class="header-section-number">9</span> Hypothesis testing</a></div>
<div class="next"><a href="non-parametric-test.html"><span class="header-section-number">11</span> Non-parametric test</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#parametric-test"><span class="header-section-number">10</span> Parametric test</a></li>
<li>
<a class="nav-link" href="#sec-t-test"><span class="header-section-number">10.1</span> \(t\)-test</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#one-t"><span class="header-section-number">10.1.1</span> One sample \(t\)-test</a></li>
<li><a class="nav-link" href="#ind-t"><span class="header-section-number">10.1.2</span> Independent t-test</a></li>
<li><a class="nav-link" href="#pair-t"><span class="header-section-number">10.1.3</span> Paired t-test</a></li>
</ul>
</li>
<li><a class="nav-link" href="#ANOVA"><span class="header-section-number">10.2</span> Analysis of Variance (ANOVA)</a></li>
<li>
<a class="nav-link" href="#correlation-test"><span class="header-section-number">10.3</span> Correlation test</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#pearson"><span class="header-section-number">10.3.1</span> Pearson correlation</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A gentle introduction to R for biologists</strong>" was written by Kittinun Leetanaporn. It was last built on 2023-12-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
