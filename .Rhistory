iris_pw_rank
iris_pw_rank <- iris_pw |>
arrange(`Petal.Width`) |>
mutate(Rank = rank(`Petal.Width`, ties.method = "average")) # rank all values
iris_pw_rank
long_df |>
group_by(Metrics, Species) |>
summarise(normality = round(shapiro.test(cm)$p.value,4))
ggplot(long_df, aes(x = cm, fill = Metrics)) + geom_histogram() +
facet_grid(Metrics~Species, scales = "free") +
theme_bw()
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw,exact=FALSE,correct=FALSE)
p_wil
p_wil$p.value
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
setosa
stat::wilcox.formula
?stats::wilcox.formula
?stats::wilcox.tets.formula
?stats::wilcox.test.formula
A = c(2,4,6,8,10,12,14,16,18); B = c(5,7,9,11,13,15,17,19,21,23); wilcox.test(A,B); W = 28; m = 9; n = 10; pwilcox(28, 9, 10, lower.tail=TRUE)*2.
A = c(2,4,6,8,10,12,14,16,18); B = c(5,7,9,11,13,15,17,19,21,23); wilcox.test(A,B); W = 28; m = 9; n = 10; pwilcox(28, 9, 10, lower.tail=TRUE)*2.
wilcox.test(A,B);
W = 28; m = 9; n = 10; pwilcox(28, 9, 10, lower.tail=TRUE)*2.
wilcox.test(A,B);
W = 28; m = 9; n = 10; pwilcox(28, 9, 10, lower.tail=TRUE)*2.
wilcox.test(A,B);
W = 28; m = 9; n = 10; pwilcox(28, 9, 10, lower.tail=TRUE)*2.
pwilcox(W, nrow(setosa), nrow(versicolor), lower.tail = TRUE)*2
pwilcox(W, nrow(setosa), nrow(versicolor))*2
pwilcox(W, nrow(setosa), nrow(versicolor))*2
pwilcox(W, nrow(setosa), nrow(versicolor))
pwilcox(W, nrow(setosa), nrow(versicolor), lower.tail = TRUE)
pwilcox(W, nrow(setosa), nrow(versicolor), lower.tail = TRUE)
pwilcox(0, nrow(setosa), nrow(versicolor), lower.tail = TRUE)
pwilcox(W, nrow(setosa), nrow(versicolor), lower.tail = TRUE)
W
pwilcox(0, nrow(setosa), nrow(versicolor), lower.tail = TRUE)
pwilcox(W, 50,50, lower.tail = TRUE)
pwilcox(0, 50,50, lower.tail = TRUE)
p_wil
p_wil$statistic
p_wil$p.value
p_wil ==pwilcox(0, 50,50, lower.tail = TRUE)
p_wil ==pwilcox(0, 50,50, lower.tail = TRUE)2
p_wil ==pwilcox(0, 50,50, lower.tail = TRUE)*2
pwilcox(0, 50,50, lower.tail = TRUE)
p_wil
p_wil$p.value ==pwilcox(0, 50,50, lower.tail = TRUE)*2
?wilcox.test.formula()
methods(wilcox.test())
methods(wilcox.test
methods(wilcox.test)
methods(wilcox.test)
methods(wilcox.test)
pwilcox(0, 50,50, lower.tail = TRUE)*2
wilcox.test(A,B);
setosa
unique(setosa$Rank)
unique(versicolor$Rank)
pwilcox(0, 6,9, lower.tail = TRUE)*2
pwilcox(0, 50,50, lower.tail = TRUE)*2
all_combn
iris_pw_rank |> count(Species)
iris_pw_rank
iris_pw_rank |> count(Species)
df
iris_pw |> filter(Species == "setosa")
wilcox.test(setosa$Petal.Width, versicolor$Petal.Width)
wilcox.test(setosa$Petal.Width, versicolor$Petal.Width)$p.value
pwilcox(0, 50,50, lower.tail = TRUE)*2
wilcox.test(versicolor$Petal.Width,setosa$Petal.Width)$p.value
wilcox.test(versicolor$Petal.Width,setosa$Petal.Width)$p.value
p_wil$p.value
iris_pw <- df |>
select(Petal.Width, Species) |>
filter(Species != "versicolor" )
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
wilcox.test(Petal.Width~Species, data = iris_pw)
p_wil$p.value
iris_pw_rank <- iris_pw |>
arrange(`Petal.Width`) |>
mutate(Rank = rank(`Petal.Width`, ties.method = "average")) # rank all values
setosa <- split(iris_pw_rank, iris_pw$Species)$setosa
versicolor <- split(iris_pw_rank, iris_pw$Species)$versicolor
all_combn <- nrow(setosa)*nrow(versicolor)
all_combn
setosa_rank_sum <- all_combn + (nrow(setosa)*(nrow(setosa)+1))/2 - sum(setosa$Rank)
setosa_rank_sum
versicolor_rank_sum <- all_combn + (nrow(versicolor)*(nrow(versicolor)+1))/2 - sum(versicolor$Rank)
versicolor_rank_sum
W <- min(setosa_rank_sum,versicolor_rank_sum)
W
pwilcox(0, 50,50, lower.tail = TRUE)*2
p_wil$p.value
p_wil$p.value
iris_pw <- df |>
select(Petal.Width, Species) |>
filter(Species != "versicolor" )
iris_pw
iris_pw <- df |>
select(Petal.Width, Species) |>
filter(Species != "setosa" )
iris_pw
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
wilcox.test(Petal.Width~Species, data = iris_pw)
p_wil$p.value
wilcox.test(Petal.Width~Species, data = iris_pw)
iris_pw_rank <- iris_pw |>
arrange(`Petal.Width`) |>
mutate(Rank = rank(`Petal.Width`, ties.method = "average")) # rank all values
wilcox.test(versicolor$Petal.Width,setosa$Petal.Width)$p.value
setosa <- split(iris_pw_rank, iris_pw$Species)$setosa
versicolor <- split(iris_pw_rank, iris_pw$Species)$versicolor
all_combn <- nrow(setosa)*nrow(versicolor)
all_combn
setosa_rank_sum <- all_combn + (nrow(setosa)*(nrow(setosa)+1))/2 - sum(setosa$Rank)
setosa_rank_sum
versicolor_rank_sum <- all_combn + (nrow(versicolor)*(nrow(versicolor)+1))/2 - sum(versicolor$Rank)
versicolor_rank_sum
W <- min(setosa_rank_sum,versicolor_rank_sum)
W
W
versicolor_rank_sum
versicolor_rank_sum
versicolor
iris_pw_rank
setosa <- split(iris_pw_rank, iris_pw$Species)$verginica
versicolor <- split(iris_pw_rank, iris_pw$Species)$versicolor
all_combn <- nrow(setosa)*nrow(versicolor)
all_combn <- nrow(setosa)*nrow(versicolor)
all_combn
setosa_rank_sum <- all_combn + (nrow(setosa)*(nrow(setosa)+1))/2 - sum(setosa$Rank)
setosa_rank_sum
versicolor_rank_sum <- all_combn + (nrow(versicolor)*(nrow(versicolor)+1))/2 - sum(versicolor$Rank)
versicolor_rank_sum
W <- min(setosa_rank_sum,versicolor_rank_sum)
W
versicolor_rank_sum
versicolor_rank_sum
setosa
iris_pw_rank <- iris_pw |>
arrange(`Petal.Width`) |>
mutate(Rank = rank(`Petal.Width`, ties.method = "average")) # rank all values
iris_pw_rank
setosa <- split(iris_pw_rank, iris_pw$Species)$virginica
setosa
versicolor <- split(iris_pw_rank, iris_pw$Species)$versicolor
all_combn <- nrow(setosa)*nrow(versicolor)
all_combn
setosa_rank_sum <- all_combn + (nrow(setosa)*(nrow(setosa)+1))/2 - sum(setosa$Rank)
setosa_rank_sum
versicolor_rank_sum <- all_combn + (nrow(versicolor)*(nrow(versicolor)+1))/2 - sum(versicolor$Rank)
versicolor_rank_sum
W <- min(setosa_rank_sum,versicolor_rank_sum)
W
pwilcox(0, 50,50, lower.tail = TRUE)*2
pwilcox(W, 50,50, lower.tail = TRUE)*2
p_wil$p.value
pwilcox(W, 50,50, lower.tail = TRUE)*2
pwilcox(W, 50,50, lower.tail = TRUE)*2
p_wil$p.value
p_wil
setosa_rank_sum
versicolor_rank_sum
versicolor_rank_sum <- all_combn + (nrow(versicolor)*(nrow(versicolor)+1))/2 - sum(versicolor$Rank)
versicolor_rank_sum
all_combn
(nrow(versicolor)*(nrow(versicolor)+1))/2
sum(versicolor$Rank)
setosa_rank_sum <- all_combn + (nrow(setosa)*(nrow(setosa)+1))/2 - sum(setosa$Rank)
setosa_rank_sum
all_combn
(nrow(setosa)*(nrow(setosa)+1))/2
sum(setosa$Rank)
setosa_rank_sum
versicolor_rank_sum <- all_combn + (nrow(versicolor)*(nrow(versicolor)+1))/2 - sum(versicolor$Rank)
versicolor_rank_sum
W <- min(setosa_rank_sum,versicolor_rank_sum)
W
pwilcox(W, 50,50, lower.tail = TRUE)*2
wilcox.test(setosa$Species, versicolor$Species)
wilcox.test(setosa$Species, versicolor$Species)
wilcox.test(setosa$`Petal.Width`, versicolor$`Petal.Width`)
wilcox.test(setosa$`Petal.Width`, versicolor$`Petal.Width`)
wilcox.test(versicolor$`Petal.Width` ,setosa$`Petal.Width`)
versicolor_rank_sum
W <- min(setosa_rank_sum,versicolor_rank_sum)
W
wilcox.test(versicolor$`Petal.Width` ,setosa$`Petal.Width`)
W
pwilcox(W, 50,50, lower.tail = TRUE)*2
pnorm(W, 50,50, lower.tail = TRUE)*2
pnorm(W, 50,50, lower.tail = TRUE)*2
W
pnorm(W, 50,50, lower.tail = TRUE)*2
pwilcox(W, 50,50, lower.tail = TRUE)*2
pwilcox(W, 50,50, lower.tail = TRUE)*2
pwilcox(W, m=50,n=50, lower.tail = TRUE)*2
W = 28; m = 9; n = 10; pwilcox(28, 9, 10, lower.tail=TRUE)*2.
pwilcox(W, m=50,n=50, lower.tail = TRUE)*2.
pwilcox(W, m=50,n=50, lower.tail = TRUE)*2.
pwilcox(W, m=50,n=50, lower.tail = TRUE)*2
W
pwilcox(W, m=50,n=50, lower.tail = TRUE)*2
pwilcox(2, m=50,n=50, lower.tail = TRUE)*2
pwilcox(2, m=50,n=50, lower.tail = TRUE, log.p=TRUE)*2
pwilcox(2, m=50,n=50, lower.tail = TRUE)*2
pwilcox(28, 9, 10, lower.tail=TRUE)
W = 28; m = 9; n = 10; pwilcox(28, 9, 10, lower.tail=TRUE)*2.
A = c(2,4,6,8,10,12,14,16,18); B = c(5,7,9,11,13,15,17,19,21,23);
wilcox.test(A,B);
iris_pw <- df |>
select(Petal.Width, Species) |>
filter(Species != "virginica" )
iris_pw
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
wilcox.test(Petal.Width~Species, data = iris_pw)
p_wil$p.value
p_wil$p.value
wilcox.test(Petal.Width~Species, data = iris_pw)
wilcox.test(Petal.Width~Species, data = iris_pw, paired = TRUE)
p_wil$p.value
p_wil$p.value
wilcox.test(Petal.Width~Species, data = iris_pw, paired = TRUE)
p_wil$p.value
wilcox.test(Petal.Width~Species, data = iris_pw, paired = TRUE)
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw, paired = TRUE)
p_wil$p.value
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
p_wil
(1-pwilcox(2, m=50,n=50, lower.tail = FALSE))*2
(1-pwilcox(2, m=50,n=50, lower.tail = FALSE))*2
(1-pwilcox(2, m=50,n=50, lower.tail = FALSE))*2
iris_pw <- df |>
select(Petal.Width, Species) |>
filter(Species != "virginica" )
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
wilcox.test(Petal.Width~Species, data = iris_pw)
p_wil$p.value
iris_pw_rank <- iris_pw |>
arrange(`Petal.Width`) |>
mutate(Rank = rank(`Petal.Width`, ties.method = "average")) # rank all values
wilcox.test(versicolor$`Petal.Width` ,setosa$`Petal.Width`)
setosa <- split(iris_pw_rank, iris_pw$Species)$virginica
versicolor <- split(iris_pw_rank, iris_pw$Species)$versicolor
all_combn <- nrow(setosa)*nrow(versicolor)
all_combn
setosa_rank_sum <- all_combn + (nrow(setosa)*(nrow(setosa)+1))/2 - sum(setosa$Rank)
setosa_rank_sum
versicolor_rank_sum <- all_combn + (nrow(versicolor)*(nrow(versicolor)+1))/2 - sum(versicolor$Rank)
versicolor_rank_sum
W <- min(setosa_rank_sum,versicolor_rank_sum)
W
mU = all_combn/2
sdU = sqrt(all_combn*(100+1)/12)
z = (U-mU)/sdU
sdU = sqrt(all_combn*(100+1)/12)
sdU
U
z = (W-mU)/sdU
pval = 2*pnorm(-abs(z))
pval
z
sdU
all_combn
all_combn <- nrow(setosa)*nrow(versicolor)
all_combn
all_combn
iris_pw <- df |>
select(Petal.Width, Species) |>
filter(Species != "virginica" )
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
wilcox.test(Petal.Width~Species, data = iris_pw)
p_wil$p.value
iris_pw_rank <- iris_pw |>
arrange(`Petal.Width`) |>
mutate(Rank = rank(`Petal.Width`, ties.method = "average")) # rank all values
setosa <- split(iris_pw_rank, iris_pw$Species)$virginica
versicolor <- split(iris_pw_rank, iris_pw$Species)$versicolor
setosa <- split(iris_pw_rank, iris_pw$Species)$setosa
versicolor <- split(iris_pw_rank, iris_pw$Species)$versicolor
all_combn <- nrow(setosa)*nrow(versicolor)
all_combn
all_combn
setosa_rank_sum <- all_combn + (nrow(setosa)*(nrow(setosa)+1))/2 - sum(setosa$Rank)
setosa_rank_sum
versicolor_rank_sum <- all_combn + (nrow(versicolor)*(nrow(versicolor)+1))/2 - sum(versicolor$Rank)
versicolor_rank_sum <- all_combn + (nrow(versicolor)*(nrow(versicolor)+1))/2 - sum(versicolor$Rank)
versicolor_rank_sum
W <- min(setosa_rank_sum,versicolor_rank_sum)
W
W <- min(setosa_rank_sum,versicolor_rank_sum)
W
mU = all_combn/2
sdU = sqrt(all_combn*(100+1)/12)
z = (W-mU)/sdU
pval = 2*pnorm(-abs(z))
pval
wilcox.test(Petal.Width~Species, data = iris_pw, exact = TRUE)
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw,exact=TRUE)
p_wil
p_wil$p.value
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw,exact=TRUE)
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
wilcox.test(Petal.Width~Species, data = iris_pw, exact = TRUE)
sdU <- sqrt(all_combn*(nrow(setosa)+nrow(versicolor)+1)/12)
z = (W-mU)/sdU
pval = 2*pnorm(-abs(z))
z
z = (W-mU)/sdU
## Normal approximation
mW <- all_combn/2
sdW <- sqrt(all_combn*(nrow(setosa)+nrow(versicolor)+1)/12)
z = (W-mW)/sdW
z = (W-mW)/sdW
pval <- 2*pnorm(-abs(z))
pval
iris_pw <- df |>
select(Petal.Width, Species) |>
filter(Species != "virginica" )
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
wilcox.test(Petal.Width~Species, data = iris_pw, exact = TRUE)
p_will
p_will$p.value
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
p_will
p_wil <- wilcox.test(Petal.Width~Species, data = iris_pw)
p_will
p_wil
p_wil$p.value
pval
pval
## Normal approximation
mW <- all_combn/2
sdW <- sqrt(all_combn*(nrow(setosa)+nrow(versicolor)+1)/12)
pval <- 2*pnorm(-abs(z))
pval
data.frame(before = runif(20, mean = 200, sd = 50) )
runif(20, mean = 200, sd = 50)
runif(20, mean = 200, sd = 10)
runif(20, mean = 200, sd = 10)
?runif
data.frame(before = runif(20, min = 400, max = 500) )
data.frame(before (um) = runif(20, min = 400, max = 500) )
data.frame(`before (um)` = runif(20, min = 400, max = 500) )
?rbeta
data.frame(`before(um)` = runif(20, min = 400, max = 500),
`after(um)` = rbeta(20,1,2 ))
data.frame(`before` = runif(20, min = 400, max = 500),
`after` = rbeta(20,1,2, ncp = 400 ))
data.frame(`before` = runif(20, min = 400, max = 500),
`after` = rbeta(20,200,200 ))
data.frame(`before` = runif(20, min = 400, max = 500),
`after` = rbeta(20,200,200 ))
data.frame(`before` = runif(20, min = 400, max = 500),
`after` = rbeta(20,200,200 ))
data.frame(`before` = runif(20, min = 400, max = 500),
`after` = rnonnorm(20, mean = 200, sd = 30))
install.packages("rnonnorm")
install.packages("detectnorm")
data.frame(before = runif(20, min = 400, max = 500),
after_a = detectnorm::rnonnorm(20, mean = 200, sd = 30),
after_b = detectnorm::rnonnorm(20, mean = 400, sd = 50))
detectnorm::rnonnorm(20, mean = 200, sd = 30)
data.frame(before = runif(20, min = 400, max = 500),
after_a = detectnorm::rnonnorm(20, mean = 200, sd = 30)$dat,
after_b = detectnorm::rnonnorm(20, mean = 400, sd = 50)$dat)
data.frame(before = runif(20, min = 400, max = 500),
after_a = detectnorm::rnonnorm(20, mean = 200, sd = 30)$dat,
after_b = detectnorm::rnonnorm(20, mean = 400, sd = 50)$dat) |>
pivot_longer(!before, names_to = "group", values_to =" after")
data.frame(before = runif(20, min = 400, max = 500),
a = detectnorm::rnonnorm(20, mean = 200, sd = 30)$dat,
b = detectnorm::rnonnorm(20, mean = 400, sd = 50)$dat) |>
pivot_longer(!before, names_to = "group", values_to =" after")
data.frame(before = runif(20, min = 400, max = 500),
after = detectnorm::rnonnorm(20, mean = 400, sd = 50)$dat) |>
pivot_longer(!before, names_to = "group", values_to =" after")
data.frame(before = runif(20, min = 400, max = 500),
after = detectnorm::rnonnorm(20, mean = 400, sd = 50)$dat)
treat<- data.frame(sample = 1:20,
before = runif(20, min = 400, max = 500),
after = detectnorm::rnonnorm(20, mean = 400, sd = 50)$dat)
treat
treat<- data.frame(sample = 1:20,
before = runif(20, min = 400, max = 500),
after = detectnorm::rnonnorm(20, mean = 400, sd = 50)$dat)
treat
treat
wilcox.test(treat$before, treat$after)
wilcox.test(treat$before, treat$after, paired = TRUE)
wilcox.test(treat$before, treat$after, paired = TRUE)
wilcox.test(treat$before, treat$after, paired = TRUE, exact = TRUE)
?wilcox.test
wilcox.test(treat$before, treat$after, paired = TRUE, correct = FALSE)
treat |> mutate(diff = before-after)
treat <- data.frame(sample = 1:20,
before = runif(20, min = 400, max = 500),
after = detectnorm::rnonnorm(20, mean = 300, sd = 50)$dat)
treat
wilcox.test(treat$before, treat$after, paired = TRUE, correct = FALSE)
treat |> mutate(diff = before-after)
treat <- data.frame(sample = 1:20,
before = runif(20, min = 400, max = 500),
after = detectnorm::rnonnorm(20, mean = 300, sd = 30)$dat)
treat
wilcox.test(treat$before, treat$after, paired = TRUE, correct = FALSE)
wilcox.test(treat$before, treat$after, paired = TRUE, correct = FALSE)
?detectnorm::rnonnorm
treat <- data.frame(sample = 1:20,
before = runif(20, min = 400, max = 500),
after = detectnorm::rnonnorm(20, mean = 300, sd = 30, sew = 10, kurt = -5)$dat)
treat <- data.frame(sample = 1:20,
before = runif(20, min = 400, max = 500),
after = detectnorm::rnonnorm(20, mean = 300, sd = 30, skew = 10, kurt = -5)$dat)
hist(detectnorm::rnonnorm(20, mean = 300, sd = 30, skew = 10, kurt = -5))
hist(detectnorm::rnonnorm(20, mean = 300, sd = 30, skew = 10, kurt = -5)$dat)
treat |> mutate(diff = before-after)
treat <- data.frame(sample = 1:20,
before = runif(20, min = 400, max = 500),
after = detectnorm::rnonnorm(20, mean = 300, sd = 30, skew = 10, kurt = 5)$dat)
wilcox.test(treat$before, treat$after, paired = TRUE, correct = FALSE)
treat |> mutate(diff = before-after)
treat |> mutate(diff = before-after) |>
mutate(absdiff = abs(diff))
treat <- data.frame(sample = 1:20,
Before = runif(20, min = 400, max = 500),
After = detectnorm::rnonnorm(20, mean = 300, sd = 30, skew = 10, kurt = 5)$dat)
wilcox.test(treat$Before, treat$After, paired = TRUE, correct = FALSE)
treat |> mutate(diff = Before-After) |>
mutate(Absdiff = abs(Diff)) |>
mutate()
W
treat |> mutate(diff = Before-After) |>
mutate(Absdiff = abs(Diff)) |>
mutate(Rank = rank(Absdiff, ties.method = "average"))
treat |> mutate(Diff = Before-After) |>
mutate(Absdiff = abs(Diff)) |>
mutate(Rank = rank(Absdiff, ties.method = "average"))
treat |> mutate(Diff = Before-After) |>
mutate(Absdiff = abs(Diff)) |>
mutate(Rank = rank(Absdiff, ties.method = "average")) |>
group_by(sign(Diff))
set.seeds(123)
treat <- data.frame(sample = 1:20,
Before = runif(20, min = 400, max = 500),
After = detectnorm::rnonnorm(20, mean = 300, sd = 30, skew = 10, kurt = 5)$dat)
set.seed(123)
treat <- data.frame(sample = 1:20,
Before = runif(20, min = 400, max = 500),
After = detectnorm::rnonnorm(20, mean = 300, sd = 30, skew = 10, kurt = 5)$dat)
wilcox.test(treat$Before, treat$After, paired = TRUE, correct = FALSE)
treat |> mutate(Diff = Before-After) |>
mutate(Absdiff = abs(Diff)) |>
mutate(Rank = rank(Absdiff, ties.method = "average")) |>
group_by(sign(Diff))
treat <- data.frame(sample = 1:20,
Before = runif(20, min = 400, max = 500),
After = detectnorm::rnonnorm(20, mean = 400, sd = 30, skew = 10, kurt = 5)$dat)
wilcox.test(treat$Before, treat$After, paired = TRUE, correct = FALSE)
treat |> mutate(Diff = Before-After) |>
mutate(Absdiff = abs(Diff)) |>
mutate(Rank = rank(Absdiff, ties.method = "average")) |>
group_by(sign(Diff))
treat_rank <- treat |> mutate(Diff = Before-After) |>
mutate(Absdiff = abs(Diff)) |>
mutate(Rank = rank(Absdiff, ties.method = "average"))
treat_rank
treat_rank |> group_by(sign(Diff))
treat_rank |> group_by(sign(Diff)) |>
summarize(sum(Rank))
sign_rank
sign_rank <- treat_rank |> group_by(sign(Diff)) |>
summarize(sum(Rank))
sign_rank
min(sign_rank$rank_sum)
min(sign_rank$rank_sum)
sign_rank <- treat_rank |> group_by(sign(Diff)) |>
summarize(rank_sum = sum(Rank))
min(sign_rank$rank_sum)
W
W <- min(sign_rank$rank_sum)
W
pwilcox(W, 20,20)
pwilcox(W, 20,20)*2
wilcox.test(treat$Before, treat$After, paired = TRUE, correct = FALSE)
sign_rank <- treat_rank |> group_by(sign(Diff)) |>
summarize(rank_sum = sum(Rank))
W <- min(sign_rank$rank_sum)
W
pwilcox(W, 20,20)*2
?pwilcox(W, 20,20)*2
?pwilcox(W, 20,20)
wilcox.test(treat$Before, treat$After, paired = TRUE, exact = TRUE, correct = FALSE)
wilcox.test(treat$Before, treat$After, paired = TRUE, exact = TRUE)
psignrank(W, 20,20)
psignrank(W, 20,20)*2
wilcox.test(treat$Before, treat$After, paired = TRUE, exact = TRUE)
treat_rank <- treat |> mutate(Diff = Before-After) |>
mutate(Absdiff = abs(Diff)) |>
mutate(Rank = rank(Absdiff, ties.method = "average"))
treat_rank
sign_rank <- treat_rank |> group_by(sign(Diff)) |>
summarize(rank_sum = sum(Rank))
V <- min(sign_rank$rank_sum)
V
pval <- psignrank(W, 20,20)*2
pval
bookdown::serve_book()
knitr::include_graphics("Picture/cell_migration.jpg")
bookdown::serve_book()
