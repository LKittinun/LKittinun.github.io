gene_sameple |> group_by(gene) |>
summarize(mean = mean(Count), var = var(Count))
gene_sample |> group_by(gene) |>
summarize(mean = mean(Count), var = var(Count))
gene_sample |> group_by(gene_name) |>
summarize(mean = mean(Count), var = var(Count))
gene_sample |> group_by(gene_name)
gene_sample |> group_by(gene_name) |>
summarize(mean = mean(Count), var = var(Count))
rpois(1000, 30)
pois <- rpois(1000, 30)
pois
mean(pois)
var(pois)
gene_sample |> group_by(gene_name) |>
summarize(mean = mean(Count), var = var(Count))
gene_sample |> group_by(gene_name) |>
summarize(mean = mean(Count), var = var(Count))
glm(Count~Group2, family = "poission", data = gene_sample)
glm(Count~Group2, family = "poisson", data = gene_sample)
dispersiontest(glm(Count~Group2, family = "poisson", data = gene_sample))
install.packages("AER")
AER::dispersiontest(glm(Count~Group2, family = "poisson", data = gene_sample))
AER::dispersiontest(glm(Count~Group2, family = "poisson", data = gene_sample))
glm(Count~Group2, family = "quasipoisson", data = gene_sample)
glm(Count~Group2, family = "quasipoisson", data = gene_sample)
ggplot(gene_sample, aes(x = Group2, y = Count, fill = Group)) +
geom_boxplot( flip = TRUE) +
geom_smooth(aes(group = 1), method = "glm", se = FALSE,
method.args = list(family = "quasipoisson"))  +
facet_wrap(~gene_name, scales = "free") +
scale_x_continuous(breaks = c(0,1)) + theme_bw()
ggplot(gene_sample, aes(x = Group2, y = Count, fill = Group)) +
geom_boxplot( flip = TRUE) +
geom_smooth(aes(group = 1), method = "glm", formula = y~1, se = FALSE,
method.args = list(family = "quasipoisson"))  +
facet_wrap(~gene_name, scales = "free") +
scale_x_continuous(breaks = c(0,1)) + theme_bw()
ggplot(gene_sample, aes(x = Group2, y = Count, fill = Group)) +
geom_boxplot() +
geom_smooth(aes(group = 1), method = "glm", formula = y~1, se = FALSE,
method.args = list(family = "quasipoisson"))  +
facet_wrap(~gene_name, scales = "free") +
scale_x_continuous(breaks = c(0,1)) + theme_bw()
glm(Count~Group2, family = "quasipoisson", data = gene_sample)
glm(Count~Group2, family = "quasipoisson", data = gene_sample) |> summary()
gene_sample |> group_by(gene_name) |>
summarize(mean = mean(Count), var = var(Count))
ggplot(gene_sample, aes(x = Group2, y = Count, fill = Group)) +
geom_boxplot() +
geom_smooth(aes(group = 1), method = "glm", formula = y~1, se = FALSE,
method.args = list(family = "quasipoisson"))  +
facet_wrap(~gene_name, scales = "free") +
scale_x_continuous(breaks = c(0,1)) + theme_bw()
BiocManager::install("voom")
?limma::voom
bladder_gene
bladder_gene |>
select(-gene_id)
head(GSE63514_meta, 10)
head(GSE63514, 10)
GSE63514
GSE63514
GSE63514 |>
summarize(across(-probe), ~var(.x))
GSE63514 |>
summarize(across(-probe), var)
GSE63514 |> select(-probe)
summarize(everything(), var)
summarize(across(everything(), var))
summarize(across(everything(),var =  var))
summarize(across(everything(),var =  sd))
summarize(across(everything(),list(var = var)))
?var
summarize(across(everything(),list(var = var)))
GSE63514 |> select(-probe) |>
summarize(across(everything(),list(var = var)))
GSE63514 |> select(-probe) |>
summarize(across(everything(),var))
GSE63514 |> select(-probe) |>
summarize(across(everything(),sd))
summarize(c_across(everything(),sd))
summarize(sd(c_across(everything())))
summarize(sd(c_across(everything())))
GSE63514 |> select(-probe) |>
rowwise()
GSE63514 |> select(-probe) |>
rowwise()
GSE63514 |> select(-probe) |>
rowwise() |>
summarize(sd(c_across(everything())))
GSE63514 |> select(-probe) |>
rowwise() |>
summarize(stat::var(c_across(everything())))
?var
GSE63514 |> select(-probe) |>
rowwise() |>
summarize(stats::var(c_across(everything())))
tagwise_var<- GSE63514 |> select(-probe) |>
rowwise() |>
summarize(stats::var(c_across(everything())))
tagwise_var
tagwise_var |> pull() |> hist()
tagwise_var<- GSE63514 |> select(-probe) |>
rowwise() |>
summarize(tagwise_var = stats::var(c_across(everything())))
ggplot(tagwise_var, aes(x = tagwise_var)) + geom_histogram()
ggplot(tagwise_var, aes(x = tagwise_var)) + geom_density()
ggplot(tagwise_var, aes(x = tagwise_var)) + geom_density() +
geom_vline(xintercept = mean(tagwise_var$tagwise_var))
ggplot(tagwise_var, aes(x = tagwise_var)) + geom_density() +
geom_vline(xintercept = mean(tagwise_var$tagwise_var)) +
xlab(0,4)
ggplot(tagwise_var, aes(x = tagwise_var)) + geom_density() +
geom_vline(xintercept = mean(tagwise_var$tagwise_var)) +
xlab(c(0,4))
?xlab
ggplot(tagwise_var, aes(x = tagwise_var)) + geom_density() +
geom_vline(xintercept = mean(tagwise_var$tagwise_var)) +
xlim(0,4)
ggplot(tagwise_var, aes(x = tagwise_var)) + geom_density() +
geom_vline(xintercept = mean(tagwise_var$tagwise_var)) +
xlim(0,2)
ggplot(tagwise_var, aes(x = tagwise_var)) + geom_density() +
geom_vline(xintercept = mean(tagwise_var$tagwise_var)) +
xlim(0,1)
tagwise_var
summary(tagwise_var)
ggplot(tagwise_var, aes(x = tagwise_var)) + geom_density() +
geom_vline(xintercept = mean(tagwise_var$tagwise_var)) +
xlim(0,1)
eBayes
?lmfit()
?limma::lmfit()
?limma::lmFit()
glm(Count~Group2, family = "quasipoisson", data = gene_sample) |> summary()
DoctorVisits
data("DoctorVisits", packages = "AER")
data("DoctorVisits", package = "AER")
DoctorVisits
?DoctorVisits
data(package = "curatedOvarianData")
data(TCGA_eset, package = "curatedOvarianData")
TCGA_eset
pData(TCGA_eset)
glm(percent_tumor_cells ~ age, family = "poisson", data = pData(TCGA_eset)))
glm(percent_tumor_cells ~ age, family = "poisson", data = pData(TCGA_eset))
pData(TCGA_eset)
glm(percent_tumor_cells ~ age_at_initial_pathologic_diagnosis, family = "poisson", data = pData(TCGA_eset))
glm(percent_tumor_cells ~ age_at_initial_pathologic_diagnosis, family = "poisson", data = pData(TCGA_eset)) |> summary()
ggplot(pData(TCGA_eset), aes(x = age_at_initial_pathologic_diagnosis, y = percent_tumor_cells)) +
geom_line()
ggplot(pData(TCGA_eset), aes(x = age_at_initial_pathologic_diagnosis, y = percent_tumor_cells)) +
geom_point()
ggplot(pData(TCGA_eset), aes(x = age_at_initial_pathologic_diagnosis, y = percent_tumor_cells)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
ggplot(pData(TCGA_eset), aes(x = age_at_initial_pathologic_diagnosis, y = percent_tumor_cells)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson")) +
geom_smooth(method = "lm")
ggplot(pData(TCGA_eset), aes(x = age_at_initial_pathologic_diagnosis, y = percent_tumor_cells)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson")) +
geom_smooth(method = "lm", col = "red")
ggplot(pData(TCGA_eset), aes(x = age_at_initial_pathologic_diagnosis, y = percent_tumor_cells)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson")) +
geom_smooth(method = "lm", col = "red")
ggplot(pData(TCGA_eset), aes(x = age_at_initial_pathologic_diagnosis, y = percent_tumor_cells)) +
geom_point() +
#  geom_smooth(method = "glm", method.args = list(family = "poisson")) +
geom_smooth(method = "lm", col = "red")
ggplot(pData(TCGA_eset), aes(x = age_at_initial_pathologic_diagnosis, y = percent_tumor_cells)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
ggplot(pData(TCGA_eset), aes(x = age_at_initial_pathologic_diagnosis, y = percent_tumor_cells)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "quasipoisson"))
ggplot(pData(TCGA_eset), aes(x = percent_normal_cells, y = percent_tumor_cells)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "quasipoisson"))
ggplot(pData(TCGA_eset), aes(x = percent_stromal_cells, y = percent_tumor_cells)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "quasipoisson"))
data(package = "AER")
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_bw()
library(tidyverse)
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_bw()
diabetes_fit <- lm(sspg~glufast, data = Diabetes)
diabetes_fit
glm(sspg~glufast, family = "poisson"m data = Diabetes)
glm(sspg~glufast, family = "poisson", data = Diabetes)
glm(sspg~glufast, family = "poisson", data = Diabetes) |> summary*
diabetes_augment <- augment(diabetes_fit)
glm(sspg~glufast, family = "poisson", data = Diabetes) |> summary()
hist(Diabetes$glufast)
diabetes_fit <- lm(sspg~glufast, data = Diabetes)
diabetes_fit
glm(sspg~glufast, family = "poisson", data = Diabetes) |> summary()
lm(sspg~log(glufast),  data = Diabetes) |> summary()
lm(sspg~glufast^2,  data = Diabetes) |> summary()
lm(sspg~glufast^3,  data = Diabetes) |> summary()
lm(sspg~glufast^3+glufast^2,  data = Diabetes) |> summary()
SSE <- ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_segment(data = diabetes_augment,
aes(xend = glufast, yend = .fitted), linetype = "dashed") +
geom_smooth(method = "lm", se = FALSE) + theme_bw()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_bw()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", formula = y~x^3, se = FALSE) +
theme_bw()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", formula = y~x^3+x^2, se = FALSE) +
theme_bw()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", formula = y~x^3+x^2, se = FALSE) +
theme_bw()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", formula = y~x^3+I(x^2), se = FALSE) +
theme_bw()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", formula = y~I(x^3)+I(x^2), se = FALSE) +
theme_bw()
lm(sspg~I(glufast^3)+I(glufast^2),  data = Diabetes) |> summary()
lm(sspg~I(glufast^3)+I(glufast^2)+I(glufast),  data = Diabetes) |> summary()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", formula = y~I(x^3)+I(x^2)+I(x), se = FALSE) +
theme_bw()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", formula = y~I(x^5)+I(x^2)+I(x), se = FALSE) +
theme_bw()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", formula = y~I(x^10)+I(x^2)+I(x), se = FALSE) +
theme_bw()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", formula = y~I(x^11)+I(x^2)+I(x), se = FALSE) +
theme_bw()
ggplot(Diabetes, aes(x = glufast, y = sspg)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
theme_bw()
lm(sspg~glufast,  data = Diabetes) |> summary()
Diabetes
lm(sspg~glufast+glutest,  data = Diabetes) |> summary()
Diabetes
lm(sspg~glufast+group,  data = Diabetes) |> summary()
lm(sspg~glufast,  data = Diabetes) |> summary()
ovarian
library(dplyr)
library(survival)
head(ovarian)
names(ovarian)
glm(fustat ~ age + offset(futime), family = "poisson", data = ovarian)
glm(fustat ~ age + offset(futime), family = "poisson", data = ovarian)
glm(fustat ~ age + offset(futime), family = "poisson", data = ovarian)
ovarian
glm(fustat ~ age, family = "poisson", data = ovarian)
glm(fustat ~ age + offset(futime), family = "poisson", data = ovarian)
glm(fustat ~ age + offset(log(futime)), family = "poisson", data = ovarian)
glm(fustat ~ age + offset(log(futime)), family = "poisson", data = ovarian)
glm(fustat ~ age + offset(log(futime)), family = "poisson", data = ovarian) |> summary()
ovarian
glm(fustat ~ rx + offset(log(futime)), family = "poisson", data = ovarian) |> summary()
?ovarian
glm(fustat ~ resid.ds + offset(log(futime)), family = "poisson", data = ovarian) |> summary()
glm(fustat ~ age + resid.ds + offset(log(futime)), family = "poisson", data = ovarian) |> summary()
glm(fustat ~ age + resid.ds, family = "poisson", data = ovarian) |> summary()
glm(fustat ~ age + resid.ds + offset(log(futime)), family = "poisson", data = ovarian) |> summary()
ggplot(ovarian, aes(x = age, y = fustat)) + geom_point()
ggplot(ovarian, aes(x = age, y = fustat)) + geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
ggplot(ovarian, aes(x = age, y = fustat)) + geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"),
formula = y~x)
glm(fustat ~ age + resid.ds + offset(log(futime)), family = "poisson", data = ovarian) |> summary()
ovarian
ovarian |> group_by(resid.ds) |> count(fustat)
ovarian |> group_by(resid.ds) |> count(fustat) |>
glm(n~resid.da, family = "poisson", data = _)
ovarian |> group_by(resid.ds) |> count(fustat) |>
glm(n~resid.ds, family = "poisson", data = _)
ovarian |> group_by(resid.ds) |> count(fustat) |>
glm(n~resid.ds, family = "poisson", data = _) |> summary()
ovarian |> mutate(age_group = cut(age, seq(0,100,10))) |>
group_by(age_group) |> count(fustat) |>
glm(n~resid.ds, family = "poisson", data = _) |> summary()
ovarian |> mutate(age_group = cut(age, seq(0,100,10))) |>
group_by(age_group) |> count(fustat) |>
glm(n~age_group, family = "poisson", data = _) |> summary()
ovarian |> mutate(age_group = cut(age, seq(0,100,10))) |>
group_by(age_group) |> count(fustat)
ovarian |> mutate(age_group = cut(age, seq(0,100,10))) |>
group_by(age_group) |> count(fustat) |> filter(fustat==1) |>
glm(n~age_group, family = "poisson", data = _) |> summary()
data(package = "AER")
data("DoctorVisits", package = "AER")
DoctorVisits
DoctorVisits
glm(visits ~ age)
glm(visits ~ age, family = "poisson", data = DoctorVisits)
glm(visits ~ age, family = "poisson", data = DoctorVisits)
glm(visits ~ age, family = "poisson", data = DoctorVisits) |> summary()
?DoctorVisits
glm(visits ~ age, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes ( x = age, y = visits)) +
geom_point()
library(tidyverse)
ggplot(DoctorVisits, aes ( x = age, y = visits)) +
geom_point()
ggplot(DoctorVisits, aes ( x = age, y = visits)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
glm(visits ~ age, family = "poisson", data = DoctorVisits) |> summary()
glm(visits ~ income, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes ( x = age, y = visits)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes ( x = income, y = visits)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
glm(visits ~ age +income, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes ( x = income, y = visits)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
glm(visits ~ age +income, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes ( x = income, y = visits)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
lm(visits ~ age +income, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes ( x = income, y = visits)) +
geom_point() +
geom_smooth(method = "lm", method.args = list(family = "poisson"))
log(-4)
glm(visits ~ age +income, family = "poisson", data = DoctorVisits) |> summary()
exp(-5)
ggplot(DoctorVisits, aes ( x = income, y = visits)) +
geom_point() +
geom_smooth(method = "lm", method.args = list(family = "poisson"))
glm(visits ~ age +income, family = "poisson", data = DoctorVisits) |> summary()
pois_dist <- map_dfc(c(1, 2, 4, 10), ~dpois(1:20, .x)) |>
set_names(paste0("Mean = ", c(1, 2, 4, 10))) |>
mutate(numb_event = 1:20) |>
pivot_longer(!numb_event, names_to = "Mean", values_to = "value") |>
mutate(Mean = fct_relevel(Mean, paste0("Mean = ", c(1, 2, 4, 10))))
ggplot(pois_dist, aes(x = numb_event, y = value, col = Mean)) +
geom_point(size = 0.8) +
geom_line() +
scale_x_continuous(breaks = seq(0,20,2), limits = c(0,21)) +
labs(title = "Probablity that certain number of events will occur",
x = "Number of events", y = "Rate", col = "Average number of events")
glm(visits ~ age +income, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes ( x = income, y = visits)) +
geom_point() +
geom_smooth(method = "lm", method.args = list(family = "poisson"))
data("DoctorVisits", package = "AER")
ggplot(DoctorVisits, aes ( x = income, y = visits)) +
geom_point() +
geom_smooth(method = "lm", method.args = list(family = "poisson"))
library(tidyverse)
data("DoctorVisits", package = "AER")
glm(visits ~ age +income, family = "poisson", data = DoctorVisits) |> summary()
glm(visits ~ age +income, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes ( x = income, y = visits)) +
geom_point() +
geom_smooth(method = "lm", method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = income, y = visits)) +
geom_point() +
geom_smooth(method = "lm", method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = income, y = visits)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
glm(visits ~ age + income, family = "poisson", data = DoctorVisits) |> summary()
DoctorVisits
glm(visits ~  . + I(age^2), family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes (x = age, y = visits)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age^2, y = visits)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age^2, y = visits)) +
geom_point() +
geom_smooth(method = "glm", y~I(x^2) method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age, y = visits)) +
geom_point() +
geom_smooth(method = "glm", y~I(x^2) method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age, y = visits)) +
geom_point() +
geom_smooth(method = "glm", y~I(x^2) method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age, y = visits)) +
geom_point() +
geom_smooth(method = "glm", y~x^2 method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age, y = visits)) +
geom_point() +
geom_smooth(method = "glm", y~x^2 method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age, y = visits)) +
geom_point() +
geom_smooth(method = "glm", y~x^2, method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age, y = visits)) +
geom_point() +
geom_smooth(method = "glm", y~I(x^2), method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age, y = visits)) +
geom_point() +
geom_smooth(method = "glm", formula =y~I(x^2), method.args = list(family = "poisson"))
DoctorVisits
glm(visits ~  private + I(age^2), family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes (x = age, y = visits, col = private)) +
geom_point() +
geom_smooth(method = "glm", formula =y~I(x^2), method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age, y = visits, col = private)) +
geom_point() +
geom_smooth(method = "glm", method.args = list(family = "poisson"))
ggplot(DoctorVisits, aes (x = age, y = visits, col = private)) +
geom_point() +
geom_smooth(method = "glm.nb", formula =y~I(x^2))
library(MASS)
ggplot(DoctorVisits, aes (x = age, y = visits, col = private)) +
geom_point() +
geom_smooth(method = "glm.nb", formula =y~I(x^2))
glm(visits ~  private + I(age^2), family = "poisson", data = DoctorVisits) |> summary()
DoctorVisits
glm(visits ~  private + illness, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes (x = illness, y = visits, col = private)) +
geom_point() +
geom_smooth(method = "glm.nb", formula =y~I(x^2))
glm(visits ~  freepoor + illness, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes (x = illness, y = visits, col = freepoor)) +
geom_point() +
geom_smooth(method = "glm.nb", formula =y~I(x^2))
ggplot(DoctorVisits, aes (x = illness, y = visits, col = freepoor)) +
geom_point() +
geom_smooth(method = "glm.nb", formula =y~I(x^2), se = FALSE)
ggplot(DoctorVisits, aes (x = illness, y = visits, col = freepoor)) +
geom_point() +
geom_smooth(method = "glm.nb", se = FALSE)
ggplot(DoctorVisits, aes (x = illness, y = visits, col = freepoor)) +
geom_jitter() +
geom_smooth(method = "glm.nb", se = FALSE)
glm(visits ~  illness, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes (x = illness, y = visits, col = freepoor)) +
geom_jitter() +
geom_smooth(method = "glm.nb", se = FALSE)
ggplot(DoctorVisits, aes (x = illness, y = visits)) +
geom_jitter() +
geom_smooth(method = "glm.nb", se = FALSE)
ggplot(DoctorVisits, aes (x = illness, y = visits)) +
geom_jitter() +
geom_smooth(method = "glm", method.arg = list(family = "poisson"), se = FALSE)
ggplot(DoctorVisits, aes (x = illness, y = visits)) +
geom_jitter() +
geom_smooth(method = "glm", method.arg = list(family = "poisson"), se = FALSE) +
theme_bw()
ggplot(DoctorVisits, aes (x = illness, y = visits)) +
geom_jitter() +
geom_smooth(method = "glm", method.arg = list(family = "poisson"), se = FALSE) +
scale_x_continuous(breaks = 1:10)
ggplot(DoctorVisits, aes (x = illness, y = visits)) +
geom_jitter() +
geom_smooth(method = "glm", method.arg = list(family = "poisson"), se = FALSE) +
scale_x_continuous(breaks = 0:5)
glm(visits ~  age, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes (x = age, y = visits)) +
geom_jitter() +
geom_smooth(method = "glm", method.arg = list(family = "poisson"), se = FALSE) +
scale_x_continuous(breaks = 0:5)
ggplot(DoctorVisits, aes (x = age, y = visits)) +
geom_jitter() +
geom_smooth(method = "glm", method.arg = list(family = "poisson"), se = FALSE) +
scale_x_continuous(breaks = 0:5) +
theme_bw()
glm(visits ~  illness, family = "poisson", data = DoctorVisits) |> summary()
ggplot(DoctorVisits, aes (x = illness, y = visits)) +
geom_jitter() +
geom_smooth(method = "glm", method.arg = list(family = "poisson"), se = FALSE) +
scale_x_continuous(breaks = 0:5)
ggplot(DoctorVisits, aes (x = illness, y = visits)) +
geom_jitter() +
geom_smooth(method = "glm", method.arg = list(family = "poisson"), se = FALSE) +
scale_x_continuous(breaks = 0:5) +
scale_y_continuous(breaks = 0:10)
ggplot(DoctorVisits, aes (x = illness, y = visits)) +
geom_jitter() +
geom_smooth(method = "glm", method.arg = list(family = "poisson"), se = FALSE) +
scale_x_continuous(breaks = 0:5) +
scale_y_continuous(breaks = 0:9) +
theme_bw()
glm(visits ~  illness, family = "poisson", data = DoctorVisits) |> summary()
?family()
bookdown::render_book()
bookdown::render_book()
rm(list = ls())
bookdown::render_book()
