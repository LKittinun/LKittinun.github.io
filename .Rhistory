top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
mutate(Group = gsub("(Normal|Cancer)", "\\1", Case))
top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
mutate(Group = gsub("(Normal|Cancer).*", "\\1", Case))
top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Case"))
top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Case", sep = "-"))
top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Case", sep = "-"))
?separate
top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Case"), sep = "-")
top10_long
top10_long <- top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Case"), sep = "-")
top10_long
ggplot(top10_long, aes(x = SYMBOL, y = intensity, color = Group)) + geom_boxplot()
ggplot(top10_long, aes(x = SYMBOL, y = Intensity, color = Group)) + geom_boxplot()
ggplot(top10_long, aes(x = SYMBOL, y = Intensity, fill = Group)) + geom_boxplot()
ggplot(top10_long, aes(x = SYMBOL, y = Intensity, fill = Group)) +
geom_boxplot() +
theme_bw()
meta_nc
meta_nc$characteristics_ch1.1
unique(meta_nc$characteristics_ch1.1)
unique(meta_nc$`dissection:ch1`)
meta_nc <- GSE63514_meta |>
filter(grepl("Normal|CIN1|Cancer", title)) |>
select(title, `characteristics_ch1.1`, `dissection:ch1`)
exprs_nc <- GSE63514 |> select(probe, contains(c("Normal", "CIN1", "Cancer")))
meta_nc <- GSE63514_meta |>
filter(grepl("Normal|CIN1|Cancer", title)) |>
select(title, `characteristics_ch1.1`, `dissection:ch1`)
names(exprs_nc) <- c("prob", meta_nc$title) # เปลี่ยนชื่อให้อ่านง่าย
exprs_nc
head(exprs_nc, 10)
head(meta_nc, 10)
nrow(exprs_nc)
nrow(hgu133plus2_genenames)
gene_nc <- exprs_nc |>
left_join(hgu133plus2_genenames, by = c("prob"="PROBEID")) |>
relocate(c("SYMBOL", "ENTREZID", "GENENAME"), .after = "prob")
gene_nc
gene_nc
nrow(gene_nc)
top10_intensity <- gene_nc |>
select(-prob, -ENTREZID, -GENENAME) |>
mutate(total_intensity =
rowSums(select(gene_nc, -prob, -ENTREZID, -GENENAME, -SYMBOL)),
.before = "Normal-01") |>
arrange(desc(total_intensity)) |>
head(10)
top10_intensity
top10_long <- top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Case"), sep = "-")
top10_long
ggplot(top10_long, aes(x = SYMBOL, y = Intensity, fill = Group)) +
geom_boxplot() +
theme_bw()
unique(meta_nc$`dissection:ch1`)
meta_nc
?separate
top10_long <- top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Case"), sep = "-", remove = FALSE)
meta_nc
top10_long |> left_join(select(meta_nc, `dissection:ch1`))
select(meta_nc, `dissection:ch1`)
meta_nc
top10_long |> left_join(select(meta_nc, title, `dissection:ch1`))
top10_long
top10_long <- top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Case"), sep = "-", remove = FALSE)
top10_long
top10_long
top10_long <- top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Case"), sep = "-", remove = FALSE)
top10_long
top10_long <- top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Case"), sep = "-", remove = FALSE)
glimpse(top10_long)
top10_long <- top10_intensity |>
select(-total_intensity) |>
pivot_longer(-SYMBOL, names_to = "Case", values_to = "Intensity") |>
separate(Case, into = c("Group", "Number"), sep = "-", remove = FALSE)
ggplot(top10_long, aes(x = SYMBOL, y = Intensity, fill = Group)) +
geom_boxplot() +
theme_bw()
top10_long |> left_join(select(meta_nc, title, `dissection:ch1`, by = c("Case" = "title")))
top10_long |> left_join(select(meta_nc, title, `dissection:ch1`), by = c("Case" = "title"))
top10_long_dissec
top10_long_dissec <- top10_long |>
left_join(select(meta_nc, title, `dissection:ch1`),
by = c("Case" = "title"))
top10_long_dissec
ggplot(top10_long_dissect, aes(x = SYMBOL, y = intensity)) + geom_boxplot() +
facet_wrap(~`dissection:ch1`)
top10_long_dissec <- top10_long |>
left_join(select(meta_nc, title, `dissection:ch1`),
by = c("Case" = "title"))
top10_long_dissec
ggplot(top10_long_dissec, aes(x = SYMBOL, y = intensity)) + geom_boxplot() +
facet_wrap(~`dissection:ch1`)
ggplot(top10_long_dissec, aes(x = SYMBOL, y = Intensity)) + geom_boxplot() +
facet_wrap(~`dissection:ch1`)
ggplot(top10_long_dissec, aes(x = SYMBOL, y = Intensity, fill = Group)) + geom_boxplot() +
facet_wrap(~`dissection:ch1`)
ggplot(top10_long_dissec, aes(x = SYMBOL, y = Intensity, fill = Group)) + geom_boxplot() +
facet_wrap(~`dissection:ch1`)
top10_long_dissec <- top10_long_dissec |>
mutate(`dissection:ch1` = gsub("-", "", `dissection:ch1`))
top10_long_dissec
top10_long_dissec <- top10_long_dissec |>
mutate(`dissection:ch1` = gsub("-", " ", `dissection:ch1`))
top10_long_dissec <- top10_long_dissec |>
mutate(`dissection:ch1` = gsub("-", " ", `dissection:ch1`))
ggplot(top10_long_dissec, aes(x = SYMBOL, y = Intensity, fill = Group)) +
geom_boxplot() +
facet_wrap(~`dissection:ch1`)
top10_long_dissec <- top10_long_dissec |>
mutate(`dissection:ch1` = gsub("-", " ", `dissection:ch1`))
ggplot(top10_long_dissec, aes(x = SYMBOL, y = Intensity, fill = Group)) +
geom_boxplot() +
facet_wrap(~`dissection:ch1`)
top10_long_dissec <- top10_long_dissec |>
mutate(`dissection:ch1` = gsub("-", " ", `dissection:ch1`))
top10_long_dissec <- top10_long |>
left_join(select(meta_nc, title, `dissection:ch1`),
by = c("Case" = "title"))
top10_long_dissec
ggplot(top10_long_dissec, aes(x = SYMBOL, y = Intensity, fill = Group)) +
geom_boxplot() +
facet_wrap(~`dissection:ch1`)
top10_long_dissec <- top10_long_dissec |>
mutate(`dissection:ch1` = gsub("-", " ", `dissection:ch1`))
ggplot(top10_long_dissec, aes(x = SYMBOL, y = Intensity, fill = Group)) +
geom_boxplot() +
facet_wrap(~`dissection:ch1`)
ggplot(top10_long_dissec, aes(x = SYMBOL, y = Intensity, fill = Group)) +
geom_boxplot() +
facet_wrap(~`dissection:ch1`) +
theme_bw()
bookdown::render_book()
bookdown::render_book()
ggplot(top10_long, aes(x = SYMBOL, y = Intensity, fill = Group)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x =
element_text(angle = 45, vjust = 0.5, hjust=1)) # หมุนแกน x เพื่อความสวยงาม
ggplot(top10_long, aes(x = SYMBOL, y = Intensity, fill = Group)) +
geom_boxplot() +
theme_bw() +
theme(axis.text.x =
element_text(angle = 45, vjust = 1, hjust=1)) # หมุนแกน x เพื่อความสวยงาม
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
library(dplyr)
?tally()
tally(GSE63514_meta)
G
GSE63514_meta
tally(GSE63514_meta, title)
starwars()
starwars
starwars |> tally()
starwars |> group_by(species) |> tally()
starwars |> group_by(species) |> count()
bookdown::render_book()
bookdown::render_book()
df
head(df)
head(df, 10)
library(tidyverse)
head(df, 10) |> pivot_longer(!Species, names_to = "Metrics", values_to = "cm")
ggplot(df, aes(x = Species, y = Sepal.Width, fill = Species)) +
geom_boxplot()
df |>
pivot_longer(!Species, names_to = "Metrics", values_to = "cm")
df |>
pivot_longer(!Species, names_to = "Metrics", values_to = "cm") |>
head(10)
long_df <- df |>
pivot_longer(!Species, names_to = "Metrics", values_to = "cm") |>
head(10)
long_df
head(long_df,10)
long_df |>
group_by(Species, Metrics) |>
summarize(mean(cm))
long_df |>
group_by(Species, Metrics) |>
summarize(Mean = mean(cm))
long_df <- df |>
pivot_longer(!Species, names_to = "Metrics", values_to = "cm")
head(long_df,10)
long_df |>
group_by(Species, Metrics) |>
summarize(Mean = mean(cm))
wide_df <- long_df |>
pivot_wider(!Species, names_from = "Metrics", values_from = "Mean")
long_df
wide_df <- long_df |>
pivot_wider(!Species, names_from = "Metrics", values_from = "cm")
long_df <- df |>
pivot_longer(!Species, names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
head(long_df,10)
wide_df <- long_df |>
pivot_wider(!Species, names_from = "Metrics", values_from = "cm")
wide_df
long_df
long_df
wide_df <- long_df |>
pivot_wider(names_from = "Metrics", values_from = "cm")
wide_df
long_df <- df |>
pivot_longer(!Species, names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
long_df <- df |>
pivot_longer(!Species, names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
head(long_df,10)
long_df <- df |>
pivot_longer(!Species, names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
long_df |>
group_by(Species, Metrics) |>
summarize(Mean = mean(cm))
wide_df <- long_df |>
pivot_wider(!Species, names_from = "Metrics", values_from = "cm")
wide_df <- long_df |>
pivot_wider(id_cols = !Species, names_from = "Metrics", values_from = "cm")
wide_df <- long_df |>
pivot_wider(id_cols = !Species, names_from = "Metrics", values_from = cm)
wide_df <- long_df |>
pivot_wider(id_cols = !Species, names_from = "Metrics", values_from = "cm")
?iris
long_df <- df |>
pivot_longer(id_cols = !Species,
names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
?pivot_longer
long_df <- df |>
pivot_longer(cols = !Species,
names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
wide_df <- long_df |>
pivot_wider(names_from = "Metrics", values_from = "cm")
long_df <- df |>
mutate(flower_id = row_id()) # สร้าง unique id ดอกไม้แต่ละดอก
pivot_longer(cols = !flower_id,
names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
head(long_df,10)
long_df <- df |>
mutate(flower_id = row_id()) # สร้าง unique id ดอกไม้แต่ละดอก
long_df <- df |>
mutate(flower_id = row_number()) # สร้าง unique id ดอกไม้แต่ละดอก
head(long_df,10)
wide_df <- long_df |>
pivot_wider(!flower_idm names_from = "Metrics", values_from = "cm")
wide_df <- long_df |>
pivot_wider(!flower_id, names_from = "Metrics", values_from = "cm")
long_df <- df |>
mutate(flower_id = row_number()) # สร้าง unique id ดอกไม้แต่ละดอก
pivot_longer(cols = !flower_id,
names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
pivot_longer(cols = !flower_id,
names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
long_df <- df |>
mutate(flower_id = row_number()) |>  # สร้าง unique id ดอกไม้แต่ละดอก
pivot_longer(cols = !flower_id,
names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
long_df <- df |>
mutate(flower_id = row_number()) |>  # สร้าง unique id ดอกไม้แต่ละดอก
pivot_longer(cols = !flower_id,
names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
long_df <- df |>
mutate(flower_id = row_number()) |>  # สร้าง unique id ดอกไม้แต่ละดอก
pivot_longer(cols = !c(flower_id, Species),
names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
head(long_df,10)
wide_df <- long_df |>
pivot_wider(!c(flower_id, Species), names_from = "Metrics", values_from = "cm")
wide_df
wide_df <- long_df |>
pivot_wider(!c(flower_id), names_from = "Metrics", values_from = "cm")
wide_df
wide_df <- long_df |>
pivot_wider(names_from = "Metrics", values_from = "cm")
wide_df
head(wide_df, 10)
df_id <- df |>
mutate(flower_idf = row_number(),
.before = everything()) # สร้าง unique id ดอกไม้แต่ละดอก
head(df_id)
df_id <- df |>
mutate(flower_id = row_number(),
.before = everything()) # สร้าง unique id ดอกไม้แต่ละดอก
head(df_id)
long_df <- df_id |>
pivot_longer(cols = !c(flower_id, Species),
names_to = "Metrics", values_to = "cm") #ไม่รวมคอลัมน์ Species
head(long_df,10)
long_df |>
group_by(Species, Metrics) |>
summarize(Mean = mean(cm))
wide_df <- long_df |>
pivot_wider(names_from = "Metrics", values_from = "cm")
head(wide_df, 10)
long_df |>
group_by(Species, Metrics) |>
summarize(`Mean (cm)` = mean(cm))
wide_df <- long_df |>
pivot_wider(names_from = "Metrics", values_from = "cm")
head(wide_df, 10)
summary_df |>
pivot_wider(names_from = "Metrics", values_from = "min")
summary_df |>
pivot_wider(names_from = "Metrics", values_from = "Mean (cm)")
summary_df |>
pivot_wider(names_from = "Metrics", values_from = "Mean (cm)")
summary_df <- long_df |>
group_by(Species, Metrics) |>
summarize(`Mean (cm)` = mean(cm))
summary(df)
summary_df
summary_df |>
pivot_wider(names_from = "Metrics", values_from = "Mean (cm)")
summary_df_wide <- df |>
group_by(Species) |>
summarize(across(-Species, mean))
summary_df_wide
summary_df_wide <- df |>
group_by(Species) |>
summarize(across(-Species, mean))
df
summary_df_wide <- df |>
group_by(Species) |>
summarize(across(-Species, mean))
summary_df_wide <- df |>
group_by(Species) |>
summarize(across(everything(), mean))
summary_df_wide
anova(`Mean (cm)` ~ Metrics + Species, data = summary_df)
?anova
aov(`Mean (cm)` ~ Metrics + Species, data = summary_df)
aov(`Mean (cm)` ~ Metrics + Species, data = summary_df) |>
summary()
aov(cm ~ Metrics + Species, data = long_df) |>
summary()
aov(cm ~ Metrics*Species, data = long_df) |>
summary()
summary_df <- long_df |>
group_by(Species, Metrics) |>
summarize(`Median (cm)` = median(cm),`Mean (cm)` = mean(cm), `sd (cm)` = sd(cm))
summary_df <- long_df |>
group_by(Species, Metrics) |>
summarize(`Median (cm)` = median(cm),`Mean (cm)` = mean(cm), `sd (cm)` = sd(cm))
summary_df
summary_df |>
pivot_wider(names_from = "Metrics",
values_from = c("Median (cm)" ,"Mean (cm)", "sd (cm"))
summary_df |>
pivot_wider(names_from = "Metrics",
values_from = c("Median (cm)" ,"Mean (cm)", "sd (cm)"))
df |>
group_by(Species) |>
summarize(across(everything(), median(cm)), across(everything(), mean(cm)), across(everything, sd(cm)))
df |>
group_by(Species) |>
summarize(across(everything(), median(cm)),
across(everything(), mean(cm)),
across(everything, sd(cm)))
df |>
group_by(Species) |>
summarize(across(everything(), median),
across(everything(), mean),
across(everything, sd))
df |>
group_by(Species) |>
summarize(across(everything(), median),
across(everything(), mean),
across(everything(), sd))
df |>
group_by(Species) |>
summarize(median = across(everything(), median),
across(everything(), mean),
across(everything(), sd))
df |>
group_by(Species) |>
summarize(median = across(everything(), median),
mean = across(everything(), mean),
sd = across(everything(), sd))
df |>
group_by(Species) |>
summarize(across(everything(), median),
across(everything(), mean),
across(everything(), sd))
d
df
df |>
group_by(Species) |>
summarize(across(everything(), median))
df |>
group_by(Species) |>
summarize(across(everything(), median),
across(everything(), mean),
across(everything(), sd))
df |>
group_by(Species) |>
summarize(across(everything(), list(median = median, mean = mean, sd = sd)))
iris_long
ggplot(df, aes(x = Species, y = Sepal.Width, fill = Species)) +
geom_boxplot()
ggplot(df, aes(x = Species, y = Sepal.Width, fill = Species)) +
geom_boxplot()
df |> pivot_longer(cols = !c(flower_id, Species),
names_to = "Metrics", values_to = "cm") |>
ggplot(aes(x = Species, y = cm, fill = Metrics)) +
geom_boxplot()
long_df |>
ggplot(aes(x = Species, y = cm, fill = Metrics)) +
geom_boxplot()
long_df |>
ggplot(aes(x = Species, y = cm, fill = Metrics)) +
geom_boxplot()
df |>
group_by(Species) |>
summarize(mean_Petal_L = mean(Petal.Length),
median_Petal_L = median(Petal.Length),
sd_Petal_L = sd(Petal.Length),
mean_Petal_W = mean(Petal.Width),
median_Petal_W = median(Petal.Width),
sd_Petal_W = sd(Petal.Width),
mean_Setal_L = mean(Sepal.Length),
median_Setal_L = median(Sepal.Length),
sd_Setal_L = sd(Setal.Length),
mean_Setal_W = mean(Sepal.Width),
median_Setal_W = median(Sepal.Width),
sd_Setal_W = sd(Sepal.Width),
)
df |>
group_by(Species) |>
summarize(mean_Petal_L = mean(Petal.Length),
median_Petal_L = median(Petal.Length),
sd_Petal_L = sd(Petal.Length),
mean_Petal_W = mean(Petal.Width),
median_Petal_W = median(Petal.Width),
sd_Petal_W = sd(Petal.Width),
mean_Setal_L = mean(Sepal.Length),
median_Setal_L = median(Sepal.Length),
sd_Setal_L = sd(Sepal.Length),
mean_Setal_W = mean(Sepal.Width),
median_Setal_W = median(Sepal.Width),
sd_Setal_W = sd(Sepal.Width),
)
df |>
group_by(Species) |>
summarize(mean_Petal_L = mean(Petal.Length),
median_Petal_L = median(Petal.Length),
sd_Petal_L = sd(Petal.Length),
mean_Petal_W = mean(Petal.Width),
median_Petal_W = median(Petal.Width),
sd_Petal_W = sd(Petal.Width),
mean_Setal_L = mean(Sepal.Length),
median_Setal_L = median(Sepal.Length),
sd_Setal_L = sd(Sepal.Length),
mean_Setal_W = mean(Sepal.Width),
median_Setal_W = median(Sepal.Width),
sd_Setal_W = sd(Sepal.Width),
)
df |>
group_by(Species) |>
summarize(across(everything(), list(median = median, mean = mean, sd = sd)))
df |>
group_by(Species) |>
summarize(across(everything(), list(median = median, mean = mean, sd = sd)))
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
#                      tidy.opts = list(width.cutoff = 80), tidy = TRUE)
knitr::include_graphics("./Picture/Rconsole (Custom).jpg")
knitr::include_graphics("./Picture/Rstudio (Custom).jpg")
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
bookdown::render_book()
head(GSE63514_meta, 10)
